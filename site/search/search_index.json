{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Accueil","text":""},{"location":"#advanceddevsample-documentation-technique","title":"AdvancedDevSample - Documentation Technique","text":"<p>Bienvenue dans la documentation technique du projet AdvancedDevSample.</p>"},{"location":"#vue-densemble","title":"Vue d'ensemble","text":"<p>AdvancedDevSample est une application de gestion de catalogue produits d\u00e9velopp\u00e9e selon les principes de Clean Architecture et du Domain-Driven Design (DDD).</p>"},{"location":"#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<ul> <li>\ud83d\udce6 Gestion des Produits : CRUD complet avec validation m\u00e9tier</li> <li>\ud83c\udfe2 Gestion des Fournisseurs : Association produits-fournisseurs</li> <li>\ud83d\udc65 Gestion des Utilisateurs : Base utilisateurs</li> <li>\ud83d\udccb Gestion des Commandes : Syst\u00e8me de commandes avec lignes de d\u00e9tail</li> <li>\ud83d\udd12 Validation m\u00e9tier : R\u00e8gles m\u00e9tier strictes (prix positifs, invariants)</li> <li>\ud83d\udee1\ufe0f Protection DDoS : Rate limiting int\u00e9gr\u00e9</li> <li>\ud83d\udcca API REST : Interface compl\u00e8te testable via Swagger</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>Le projet suit une architecture en couches avec s\u00e9paration stricte des responsabilit\u00e9s :</p> <pre><code>graph TB\n    API[API Layer&lt;br/&gt;Controllers, Middlewares]\n    APP[Application Layer&lt;br/&gt;Services, DTOs]\n    DOM[Domain Layer&lt;br/&gt;Entities, Value Objects, Interfaces]\n    INF[Infrastructure Layer&lt;br/&gt;Repositories, Data Access]\n\n    API --&gt; APP\n    APP --&gt; DOM\n    INF --&gt; DOM\n    API --&gt; INF</code></pre>"},{"location":"#couches","title":"Couches","text":"<ul> <li>API : Point d'entr\u00e9e, Controllers, Middlewares</li> <li>Application : Services m\u00e9tier, DTOs, orchestration</li> <li>Domain : Logique m\u00e9tier, entit\u00e9s, r\u00e8gles</li> <li>Infrastructure : Acc\u00e8s donn\u00e9es, repositories</li> </ul>"},{"location":"#technologies","title":"Technologies","text":"<ul> <li>.NET 9.0 : Framework principal</li> <li>ASP.NET Core : API REST</li> <li>Swagger/OpenAPI : Documentation API</li> <li>xUnit : Tests unitaires et d'int\u00e9gration</li> <li>MkDocs Material : Documentation</li> </ul>"},{"location":"#demarrage-rapide","title":"D\u00e9marrage rapide","text":""},{"location":"#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>.NET 9.0 SDK</li> <li>IDE (Rider, Visual Studio, VS Code)</li> </ul>"},{"location":"#installation","title":"Installation","text":"<pre><code># Cloner le repository\ngit clone https://github.com/yourusername/AdvancedDevSample.git\n\n# Restaurer les d\u00e9pendances\ndotnet restore\n\n# Compiler la solution\ndotnet build\n\n# Lancer l'API\ncd AdvancedDevSample.API\ndotnet run\n</code></pre>"},{"location":"#acces-swagger","title":"Acc\u00e8s Swagger","text":"<p>Une fois l'API lanc\u00e9e, acc\u00e9dez \u00e0 Swagger UI :</p> <pre><code>https://localhost:5181/swagger\n</code></pre>"},{"location":"#regles-metier","title":"R\u00e8gles m\u00e9tier","text":""},{"location":"#produits","title":"Produits","text":"<ul> <li>\u2705 Le prix doit \u00eatre strictement positif</li> <li>\u2705 Un produit doit toujours avoir un prix valide</li> <li>\u2705 La TVA doit \u00eatre valide (entre 0 et 100%)</li> </ul>"},{"location":"#commandes","title":"Commandes","text":"<ul> <li>\u2705 Une commande doit contenir au moins une ligne</li> <li>\u2705 Les quantit\u00e9s doivent \u00eatre positives</li> </ul>"},{"location":"#structure-du-projet","title":"Structure du projet","text":"<pre><code>AdvancedDevSample/\n\u251c\u2500\u2500 AdvancedDevSample.API/          # Couche pr\u00e9sentation (Controllers, Middlewares)\n\u251c\u2500\u2500 AdvancedDevSample.Application/  # Couche application (Services, DTOs)\n\u251c\u2500\u2500 AdvancedDevSample.Domain/       # Couche domaine (Entit\u00e9s, Interfaces)\n\u251c\u2500\u2500 AdvancedDevSample.Infrastructure/ # Couche infrastructure (Repositories)\n\u251c\u2500\u2500 AdvancedDevSample.Test/         # Tests unitaires et d'int\u00e9gration\n\u2514\u2500\u2500 Docs/                           # Documentation MkDocs\n</code></pre>"},{"location":"#navigation","title":"Navigation","text":"<ul> <li>\ud83c\udfd7\ufe0f Architecture d\u00e9taill\u00e9e</li> <li>\ud83d\udd0c Documentation API</li> <li>\ud83e\uddea Guide des tests</li> <li>\ud83d\udcbb Guide d\u00e9veloppeur</li> </ul>"},{"location":"#contact","title":"Contact","text":"<p>Pour toute question ou contribution, n'h\u00e9sitez pas \u00e0 ouvrir une issue sur GitHub.</p> <p>Derni\u00e8re mise \u00e0 jour : F\u00e9vrier 2026</p>"},{"location":"api/controllers/","title":"Controllers","text":""},{"location":"api/controllers/#api-controllers","title":"API - Controllers","text":""},{"location":"api/controllers/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les Controllers sont responsables de la r\u00e9ception des requ\u00eates HTTP et de la coordination avec les services applicatifs.</p>"},{"location":"api/controllers/#controllers-disponibles","title":"Controllers disponibles","text":""},{"location":"api/controllers/#productcontroller","title":"ProductController","text":"<p>Gestion du catalogue produits (CRUD complet).</p> <p>Route : <code>/api/products</code></p> <pre><code>[ApiController]\n[Route(\"api/[controller]\")]\npublic class ProductController : ControllerBase\n{\n    private readonly ProductService _productService;\n\n    /// &lt;summary&gt;\n    /// R\u00e9cup\u00e8re tous les produits du catalogue\n    /// &lt;/summary&gt;\n    [HttpGet]\n    public async Task&lt;ActionResult&lt;IEnumerable&lt;ProductDto&gt;&gt;&gt; GetAll()\n    {\n        var products = await _productService.GetAllAsync();\n        return Ok(products);\n    }\n\n    /// &lt;summary&gt;\n    /// R\u00e9cup\u00e8re un produit par son identifiant\n    /// &lt;/summary&gt;\n    [HttpGet(\"{id}\")]\n    public async Task&lt;ActionResult&lt;ProductDto&gt;&gt; GetById(Guid id)\n    {\n        var product = await _productService.GetByIdAsync(id);\n        return product != null ? Ok(product) : NotFound();\n    }\n\n    /// &lt;summary&gt;\n    /// Cr\u00e9e un nouveau produit\n    /// &lt;/summary&gt;\n    [HttpPost]\n    public async Task&lt;ActionResult&lt;ProductDto&gt;&gt; Create(CreateProductDto dto)\n    {\n        var product = await _productService.CreateAsync(dto);\n        return CreatedAtAction(nameof(GetById), new { id = product.Id }, product);\n    }\n\n    /// &lt;summary&gt;\n    /// Met \u00e0 jour un produit existant\n    /// &lt;/summary&gt;\n    [HttpPut(\"{id}\")]\n    public async Task&lt;ActionResult&lt;ProductDto&gt;&gt; Update(Guid id, UpdateProductDto dto)\n    {\n        var product = await _productService.UpdateAsync(id, dto);\n        return Ok(product);\n    }\n\n    /// &lt;summary&gt;\n    /// Supprime un produit\n    /// &lt;/summary&gt;\n    [HttpDelete(\"{id}\")]\n    public async Task&lt;IActionResult&gt; Delete(Guid id)\n    {\n        await _productService.DeleteAsync(id);\n        return NoContent();\n    }\n}\n</code></pre>"},{"location":"api/controllers/#suppliercontroller","title":"SupplierController","text":"<p>Gestion des fournisseurs.</p> <p>Route : <code>/api/suppliers</code></p> <p>Op\u00e9rations : - <code>GET /api/suppliers</code> - Liste tous les fournisseurs - <code>GET /api/suppliers/{id}</code> - R\u00e9cup\u00e8re un fournisseur - <code>POST /api/suppliers</code> - Cr\u00e9e un fournisseur - <code>PUT /api/suppliers/{id}</code> - Met \u00e0 jour un fournisseur - <code>DELETE /api/suppliers/{id}</code> - Supprime un fournisseur</p>"},{"location":"api/controllers/#usercontroller","title":"UserController","text":"<p>Gestion des utilisateurs.</p> <p>Route : <code>/api/users</code></p> <p>Op\u00e9rations : CRUD complet</p>"},{"location":"api/controllers/#ordercontroller","title":"OrderController","text":"<p>Gestion des commandes.</p> <p>Route : <code>/api/orders</code></p> <p>Op\u00e9rations : CRUD complet avec gestion des lignes de commande</p>"},{"location":"api/controllers/#pattern-utilise","title":"Pattern utilis\u00e9","text":""},{"location":"api/controllers/#dependency-injection","title":"Dependency Injection","text":"<p>Tous les controllers re\u00e7oivent leurs d\u00e9pendances via le constructeur :</p> <pre><code>public class ProductController : ControllerBase\n{\n    private readonly ProductService _productService;\n\n    public ProductController(ProductService productService)\n    {\n        _productService = productService;\n    }\n}\n</code></pre>"},{"location":"api/controllers/#actionresult-pattern","title":"ActionResult Pattern","text":"<p>Les m\u00e9thodes retournent des <code>ActionResult&lt;T&gt;</code> pour typage fort et codes HTTP appropri\u00e9s :</p> <pre><code>public async Task&lt;ActionResult&lt;ProductDto&gt;&gt; GetById(Guid id)\n{\n    // Retourne 200 OK ou 404 Not Found\n    var product = await _productService.GetByIdAsync(id);\n    return product != null ? Ok(product) : NotFound();\n}\n</code></pre>"},{"location":"api/controllers/#attributs-de-routage","title":"Attributs de routage","text":""},{"location":"api/controllers/#apicontroller","title":"[ApiController]","text":"<p>Active la validation automatique du ModelState et autres fonctionnalit\u00e9s :</p> <pre><code>[ApiController]\n[Route(\"api/[controller]\")]\npublic class ProductController : ControllerBase\n{\n    // Validation automatique\n    // Binding automatique des sources\n    // Inf\u00e9rence automatique des types de r\u00e9ponse\n}\n</code></pre>"},{"location":"api/controllers/#httpget-httppost-etc","title":"[HttpGet], [HttpPost], etc.","text":"<p>D\u00e9finissent les verbes HTTP et routes :</p> <pre><code>[HttpGet]                    // GET /api/products\n[HttpGet(\"{id}\")]           // GET /api/products/{id}\n[HttpPost]                  // POST /api/products\n[HttpPut(\"{id}\")]          // PUT /api/products/{id}\n[HttpDelete(\"{id}\")]       // DELETE /api/products/{id}\n</code></pre>"},{"location":"api/controllers/#validation","title":"Validation","text":""},{"location":"api/controllers/#validation-automatique","title":"Validation automatique","text":"<p>ASP.NET Core valide automatiquement le ModelState :</p> <pre><code>[HttpPost]\npublic async Task&lt;ActionResult&lt;ProductDto&gt;&gt; Create(CreateProductDto dto)\n{\n    // Si ModelState invalide, retourne automatiquement 400 Bad Request\n    // gr\u00e2ce \u00e0 [ApiController]\n\n    var product = await _productService.CreateAsync(dto);\n    return CreatedAtAction(nameof(GetById), new { id = product.Id }, product);\n}\n</code></pre>"},{"location":"api/controllers/#dtos-avec-attributs-de-validation","title":"DTOs avec attributs de validation","text":"<pre><code>public record CreateProductDto(\n    [Required] string Name,\n    [StringLength(500)] string Description,\n    [Range(0.01, double.MaxValue)] decimal Price,\n    [Range(0, 100)] decimal VatRate,\n    Guid SupplierId\n);\n</code></pre>"},{"location":"api/controllers/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<p>Les controllers ne g\u00e8rent pas les exceptions directement. Le middleware <code>ExceptionHandlingMiddleware</code> s'en charge :</p> <pre><code>// \u274c \u00c0 \u00e9viter\n[HttpGet(\"{id}\")]\npublic async Task&lt;ActionResult&lt;ProductDto&gt;&gt; GetById(Guid id)\n{\n    try\n    {\n        var product = await _productService.GetByIdAsync(id);\n        return Ok(product);\n    }\n    catch (Exception ex)\n    {\n        return StatusCode(500, ex.Message);\n    }\n}\n\n// \u2705 \u00c0 faire\n[HttpGet(\"{id}\")]\npublic async Task&lt;ActionResult&lt;ProductDto&gt;&gt; GetById(Guid id)\n{\n    // Le middleware g\u00e8re les exceptions\n    var product = await _productService.GetByIdAsync(id);\n    return product != null ? Ok(product) : NotFound();\n}\n</code></pre>"},{"location":"api/controllers/#codes-de-statut-http","title":"Codes de statut HTTP","text":"Action Succ\u00e8s Erreur GetAll 200 OK 500 Internal Server Error GetById 200 OK 404 Not Found Create 201 Created 400 Bad Request Update 200 OK 404 Not Found / 400 Bad Request Delete 204 No Content 404 Not Found"},{"location":"api/controllers/#commentaires-xml","title":"Commentaires XML","text":"<p>Tous les controllers et m\u00e9thodes sont document\u00e9s avec des commentaires XML pour Swagger :</p> <pre><code>/// &lt;summary&gt;\n/// R\u00e9cup\u00e8re tous les produits du catalogue.\n/// Retourne une liste vide si aucun produit n'existe.\n/// &lt;/summary&gt;\n/// &lt;returns&gt;Liste de tous les produits sous forme de DTOs&lt;/returns&gt;\n/// &lt;response code=\"200\"&gt;Succ\u00e8s - Liste des produits retourn\u00e9e&lt;/response&gt;\n[HttpGet]\n[ProducesResponseType(StatusCodes.Status200OK)]\npublic async Task&lt;ActionResult&lt;IEnumerable&lt;ProductDto&gt;&gt;&gt; GetAll()\n{\n    // ...\n}\n</code></pre>"},{"location":"api/controllers/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'API \u2192</li> <li>Endpoints d\u00e9taill\u00e9s \u2192</li> <li>Middlewares \u2192</li> </ul>"},{"location":"api/endpoints/","title":"Endpoints","text":""},{"location":"api/endpoints/#api-endpoints","title":"API - Endpoints","text":""},{"location":"api/endpoints/#products","title":"Products","text":"<p>Gestion compl\u00e8te du catalogue produits.</p>"},{"location":"api/endpoints/#get-apiproducts","title":"GET /api/products","text":"<p>R\u00e9cup\u00e8re la liste de tous les produits.</p> <p>R\u00e9ponse : <code>200 OK</code></p> <pre><code>[\n  {\n    \"id\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"name\": \"Laptop Dell XPS 15\",\n    \"description\": \"Ordinateur portable haute performance\",\n    \"price\": 1299.99,\n    \"vatRate\": 20.0,\n    \"isActive\": true,\n    \"supplierId\": \"550e8400-e29b-41d4-a716-446655440000\"\n  }\n]\n</code></pre>"},{"location":"api/endpoints/#get-apiproductsid","title":"GET /api/products/{id}","text":"<p>R\u00e9cup\u00e8re un produit par son ID.</p> <p>Param\u00e8tres : - <code>id</code> (UUID) : Identifiant unique du produit</p> <p>R\u00e9ponses : - <code>200 OK</code> : Produit trouv\u00e9 - <code>404 Not Found</code> : Produit introuvable</p>"},{"location":"api/endpoints/#post-apiproducts","title":"POST /api/products","text":"<p>Cr\u00e9e un nouveau produit.</p> <p>Corps de la requ\u00eate :</p> <pre><code>{\n  \"name\": \"Laptop Dell XPS 15\",\n  \"description\": \"Ordinateur portable haute performance\",\n  \"price\": 1299.99,\n  \"vatRate\": 20.0,\n  \"supplierId\": \"550e8400-e29b-41d4-a716-446655440000\"\n}\n</code></pre> <p>R\u00e9ponses : - <code>201 Created</code> : Produit cr\u00e9\u00e9 avec succ\u00e8s - <code>400 Bad Request</code> : Donn\u00e9es invalides</p>"},{"location":"api/endpoints/#put-apiproductsid","title":"PUT /api/products/{id}","text":"<p>Met \u00e0 jour un produit existant.</p> <p>Param\u00e8tres : - <code>id</code> (UUID) : Identifiant du produit \u00e0 modifier</p> <p>Corps de la requ\u00eate : M\u00eame structure que POST</p> <p>R\u00e9ponses : - <code>200 OK</code> : Modification r\u00e9ussie - <code>404 Not Found</code> : Produit introuvable - <code>400 Bad Request</code> : Donn\u00e9es invalides</p>"},{"location":"api/endpoints/#delete-apiproductsid","title":"DELETE /api/products/{id}","text":"<p>Supprime un produit.</p> <p>Param\u00e8tres : - <code>id</code> (UUID) : Identifiant du produit \u00e0 supprimer</p> <p>R\u00e9ponses : - <code>204 No Content</code> : Suppression r\u00e9ussie - <code>404 Not Found</code> : Produit introuvable</p>"},{"location":"api/endpoints/#suppliers","title":"Suppliers","text":"<p>Gestion des fournisseurs.</p>"},{"location":"api/endpoints/#get-apisuppliers","title":"GET /api/suppliers","text":"<p>Liste tous les fournisseurs.</p>"},{"location":"api/endpoints/#get-apisuppliersid","title":"GET /api/suppliers/{id}","text":"<p>R\u00e9cup\u00e8re un fournisseur par ID.</p>"},{"location":"api/endpoints/#post-apisuppliers","title":"POST /api/suppliers","text":"<p>Cr\u00e9e un nouveau fournisseur.</p> <p>Corps de la requ\u00eate :</p> <pre><code>{\n  \"name\": \"Dell Inc.\",\n  \"email\": \"contact@dell.com\",\n  \"phone\": \"+33 1 23 45 67 89\"\n}\n</code></pre>"},{"location":"api/endpoints/#put-apisuppliersid","title":"PUT /api/suppliers/{id}","text":"<p>Met \u00e0 jour un fournisseur.</p>"},{"location":"api/endpoints/#delete-apisuppliersid","title":"DELETE /api/suppliers/{id}","text":"<p>Supprime un fournisseur.</p>"},{"location":"api/endpoints/#users","title":"Users","text":"<p>Gestion des utilisateurs.</p>"},{"location":"api/endpoints/#get-apiusers","title":"GET /api/users","text":"<p>Liste tous les utilisateurs.</p>"},{"location":"api/endpoints/#get-apiusersid","title":"GET /api/users/{id}","text":"<p>R\u00e9cup\u00e8re un utilisateur par ID.</p>"},{"location":"api/endpoints/#post-apiusers","title":"POST /api/users","text":"<p>Cr\u00e9e un nouvel utilisateur.</p> <p>Corps de la requ\u00eate :</p> <pre><code>{\n  \"firstName\": \"Jean\",\n  \"lastName\": \"Dupont\",\n  \"email\": \"jean.dupont@example.com\"\n}\n</code></pre>"},{"location":"api/endpoints/#put-apiusersid","title":"PUT /api/users/{id}","text":"<p>Met \u00e0 jour un utilisateur.</p>"},{"location":"api/endpoints/#delete-apiusersid","title":"DELETE /api/users/{id}","text":"<p>Supprime un utilisateur.</p>"},{"location":"api/endpoints/#orders","title":"Orders","text":"<p>Gestion des commandes.</p>"},{"location":"api/endpoints/#get-apiorders","title":"GET /api/orders","text":"<p>Liste toutes les commandes.</p>"},{"location":"api/endpoints/#get-apiordersid","title":"GET /api/orders/{id}","text":"<p>R\u00e9cup\u00e8re une commande par ID.</p>"},{"location":"api/endpoints/#post-apiorders","title":"POST /api/orders","text":"<p>Cr\u00e9e une nouvelle commande.</p> <p>Corps de la requ\u00eate :</p> <pre><code>{\n  \"userId\": \"550e8400-e29b-41d4-a716-446655440001\",\n  \"orderDate\": \"2026-02-09T10:30:00Z\",\n  \"items\": [\n    {\n      \"productId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n      \"quantity\": 2,\n      \"unitPrice\": 1299.99\n    }\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/#put-apiordersid","title":"PUT /api/orders/{id}","text":"<p>Met \u00e0 jour une commande.</p>"},{"location":"api/endpoints/#delete-apiordersid","title":"DELETE /api/orders/{id}","text":"<p>Supprime une commande.</p>"},{"location":"api/introduction/","title":"Introduction","text":""},{"location":"api/introduction/#api-introduction","title":"API - Introduction","text":""},{"location":"api/introduction/#vue-densemble","title":"Vue d'ensemble","text":"<p>L'API AdvancedDevSample est une API REST d\u00e9velopp\u00e9e avec ASP.NET Core 9.0. Elle expose des endpoints pour g\u00e9rer un catalogue produits avec ses entit\u00e9s associ\u00e9es.</p>"},{"location":"api/introduction/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>\u2705 Architecture RESTful : Respect des conventions REST</li> <li>\u2705 Documentation OpenAPI/Swagger : Interface interactive pour tester l'API</li> <li>\u2705 Validation automatique : ModelState et r\u00e8gles m\u00e9tier</li> <li>\u2705 Gestion d'erreurs centralis\u00e9e : Middleware d\u00e9di\u00e9</li> <li>\u2705 Protection DDoS : Rate limiting par IP</li> <li>\u2705 Commentaires XML : Documentation enrichie dans Swagger</li> </ul>"},{"location":"api/introduction/#url-de-base","title":"URL de base","text":"<pre><code>D\u00e9veloppement : https://localhost:5181/api\nProduction     : https://yourdomain.com/api\n</code></pre>"},{"location":"api/introduction/#ressources-disponibles","title":"Ressources disponibles","text":"Ressource Description Endpoint Products Gestion du catalogue produits <code>/api/products</code> Suppliers Gestion des fournisseurs <code>/api/suppliers</code> Users Gestion des utilisateurs <code>/api/users</code> Orders Gestion des commandes <code>/api/orders</code>"},{"location":"api/introduction/#format-des-donnees","title":"Format des donn\u00e9es","text":""},{"location":"api/introduction/#requestresponse","title":"Request/Response","text":"<ul> <li>Content-Type : <code>application/json</code></li> <li>Encodage : UTF-8</li> </ul>"},{"location":"api/introduction/#exemple-de-requete","title":"Exemple de requ\u00eate","text":"<pre><code>POST /api/products HTTP/1.1\nHost: localhost:5181\nContent-Type: application/json\n\n{\n  \"name\": \"Laptop Dell XPS 15\",\n  \"description\": \"Ordinateur portable haute performance\",\n  \"price\": 1299.99,\n  \"vatRate\": 20.0,\n  \"supplierId\": \"550e8400-e29b-41d4-a716-446655440000\"\n}\n</code></pre>"},{"location":"api/introduction/#exemple-de-reponse","title":"Exemple de r\u00e9ponse","text":"<pre><code>HTTP/1.1 201 Created\nContent-Type: application/json\nLocation: /api/products/3fa85f64-5717-4562-b3fc-2c963f66afa6\n\n{\n  \"id\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n  \"name\": \"Laptop Dell XPS 15\",\n  \"description\": \"Ordinateur portable haute performance\",\n  \"price\": 1299.99,\n  \"vatRate\": 20.0,\n  \"isActive\": true,\n  \"supplierId\": \"550e8400-e29b-41d4-a716-446655440000\"\n}\n</code></pre>"},{"location":"api/introduction/#codes-de-statut-http","title":"Codes de statut HTTP","text":"Code Description Utilisation 200 OK Op\u00e9ration r\u00e9ussie (GET, PUT) 201 Created Ressource cr\u00e9\u00e9e (POST) 204 No Content Suppression r\u00e9ussie (DELETE) 400 Bad Request Validation \u00e9chou\u00e9e 404 Not Found Ressource introuvable 500 Internal Server Error Erreur serveur"},{"location":"api/introduction/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<p>Toutes les erreurs retournent un objet JSON standardis\u00e9 :</p> <pre><code>{\n  \"message\": \"Description de l'erreur\",\n  \"details\": \"D\u00e9tails suppl\u00e9mentaires (en dev uniquement)\"\n}\n</code></pre>"},{"location":"api/introduction/#exemples-derreurs","title":"Exemples d'erreurs","text":""},{"location":"api/introduction/#erreur-de-validation-400","title":"Erreur de validation (400)","text":"<pre><code>{\n  \"message\": \"Le prix doit \u00eatre strictement positif\",\n  \"details\": \"Price: -50 (valeur fournie)\"\n}\n</code></pre>"},{"location":"api/introduction/#ressource-introuvable-404","title":"Ressource introuvable (404)","text":"<pre><code>{\n  \"message\": \"Produit avec l'ID '3fa85f64...' introuvable\"\n}\n</code></pre>"},{"location":"api/introduction/#rate-limiting","title":"Rate Limiting","text":"<p>Protection contre les abus et DDoS :</p> <ul> <li>Limite : 100 requ\u00eates par minute par IP</li> <li>En-t\u00eate de r\u00e9ponse : <code>X-RateLimit-Remaining</code></li> </ul> <p>D\u00e9passement de la limite :</p> <pre><code>HTTP/1.1 429 Too Many Requests\nRetry-After: 60\n\n{\n  \"message\": \"Trop de requ\u00eates. Veuillez r\u00e9essayer dans 60 secondes.\"\n}\n</code></pre>"},{"location":"api/introduction/#acces-swagger-ui","title":"Acc\u00e8s Swagger UI","text":"<p>Interface interactive pour tester l'API :</p> <pre><code>https://localhost:5181/swagger\n</code></pre>"},{"location":"api/introduction/#fonctionnalites-swagger","title":"Fonctionnalit\u00e9s Swagger","text":"<ul> <li>\ud83d\udcd6 Documentation compl\u00e8te de tous les endpoints</li> <li>\ud83e\uddea Test des requ\u00eates directement depuis le navigateur</li> <li>\ud83d\udcdd Exemples de requ\u00eates/r\u00e9ponses</li> <li>\ud83d\udd0d Sch\u00e9mas des mod\u00e8les de donn\u00e9es</li> </ul>"},{"location":"api/introduction/#demarrage-rapide","title":"D\u00e9marrage rapide","text":""},{"location":"api/introduction/#1-lancer-lapi","title":"1. Lancer l'API","text":"<pre><code>cd AdvancedDevSample.API\ndotnet run\n</code></pre>"},{"location":"api/introduction/#2-acceder-a-swagger","title":"2. Acc\u00e9der \u00e0 Swagger","text":"<p>Ouvrir dans un navigateur :</p> <pre><code>https://localhost:5181/swagger\n</code></pre>"},{"location":"api/introduction/#3-tester-un-endpoint","title":"3. Tester un endpoint","text":"<ol> <li>Cliquer sur GET /api/products</li> <li>Cliquer sur \"Try it out\"</li> <li>Cliquer sur \"Execute\"</li> <li>Observer la r\u00e9ponse</li> </ol>"},{"location":"api/introduction/#endpoints-par-ressource","title":"Endpoints par ressource","text":"<ul> <li>Products \u2192</li> <li>Suppliers \u2192</li> <li>Users \u2192</li> <li>Orders \u2192</li> </ul>"},{"location":"api/introduction/#middleware","title":"Middleware","text":"<ul> <li>Exception Handling \u2192</li> <li>Rate Limiting \u2192</li> </ul>"},{"location":"api/introduction/#controllers","title":"Controllers","text":"<ul> <li>Architecture des controllers \u2192</li> </ul> <p>Documentation g\u00e9n\u00e9r\u00e9e automatiquement \u00e0 partir des commentaires XML</p>"},{"location":"api/middlewares/","title":"Middlewares","text":""},{"location":"api/middlewares/#api-middlewares","title":"API - Middlewares","text":""},{"location":"api/middlewares/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les middlewares sont des composants du pipeline HTTP qui traitent les requ\u00eates et r\u00e9ponses de mani\u00e8re transversale.</p>"},{"location":"api/middlewares/#pipeline-http","title":"Pipeline HTTP","text":"<pre><code>graph LR\n    REQ[Requ\u00eate] --&gt; EXC[ExceptionHandling]\n    EXC --&gt; HTTPS[HttpsRedirection]\n    HTTPS --&gt; AUTH[Authorization]\n    AUTH --&gt; RATE[RateLimiting]\n    RATE --&gt; CTRL[Controllers]\n    CTRL --&gt; RES[R\u00e9ponse]</code></pre>"},{"location":"api/middlewares/#middlewares-disponibles","title":"Middlewares disponibles","text":""},{"location":"api/middlewares/#exceptionhandlingmiddleware","title":"ExceptionHandlingMiddleware","text":"<p>Responsabilit\u00e9 : Gestion centralis\u00e9e de toutes les exceptions.</p> <pre><code>public class ExceptionHandlingMiddleware\n{\n    private readonly RequestDelegate _next;\n    private readonly ILogger&lt;ExceptionHandlingMiddleware&gt; _logger;\n\n    public async Task InvokeAsync(HttpContext context)\n    {\n        try\n        {\n            await _next(context);\n        }\n        catch (Exception ex)\n        {\n            _logger.LogError(ex, \"Une erreur s'est produite\");\n            await HandleExceptionAsync(context, ex);\n        }\n    }\n\n    private static Task HandleExceptionAsync(HttpContext context, Exception exception)\n    {\n        context.Response.ContentType = \"application/json\";\n\n        var statusCode = exception switch\n        {\n            NotFoundException =&gt; StatusCodes.Status404NotFound,\n            ValidationException =&gt; StatusCodes.Status400BadRequest,\n            _ =&gt; StatusCodes.Status500InternalServerError\n        };\n\n        context.Response.StatusCode = statusCode;\n\n        var response = new\n        {\n            message = exception.Message,\n            details = context.RequestServices\n                .GetService&lt;IWebHostEnvironment&gt;()?.IsDevelopment() == true\n                ? exception.StackTrace\n                : null\n        };\n\n        return context.Response.WriteAsJsonAsync(response);\n    }\n}\n</code></pre> <p>Avantages : - \u2705 Gestion centralis\u00e9e des erreurs - \u2705 Code des controllers simplifi\u00e9 - \u2705 R\u00e9ponses d'erreur coh\u00e9rentes - \u2705 Logging automatique - \u2705 D\u00e9tails techniques masqu\u00e9s en production</p> <p>Enregistrement :</p> <pre><code>// Dans Program.cs\napp.UseMiddleware&lt;ExceptionHandlingMiddleware&gt;();\n</code></pre>"},{"location":"api/middlewares/#rate-limiting","title":"Rate Limiting","text":"<p>Responsabilit\u00e9 : Protection contre les abus et attaques DDoS.</p> <p>Configuration : - Limite : 100 requ\u00eates par minute par IP - Action : Retourne <code>429 Too Many Requests</code> si d\u00e9passement</p> <pre><code>public class RateLimitingMiddleware\n{\n    private static readonly ConcurrentDictionary&lt;string, (DateTime, int)&gt; _requests = new();\n    private const int MaxRequests = 100;\n    private static readonly TimeSpan TimeWindow = TimeSpan.FromMinutes(1);\n\n    public async Task InvokeAsync(HttpContext context)\n    {\n        var ipAddress = context.Connection.RemoteIpAddress?.ToString() ?? \"unknown\";\n\n        if (!IsRequestAllowed(ipAddress))\n        {\n            context.Response.StatusCode = StatusCodes.Status429TooManyRequests;\n            await context.Response.WriteAsync(\"Trop de requ\u00eates. Veuillez r\u00e9essayer plus tard.\");\n            return;\n        }\n\n        await _next(context);\n    }\n\n    private bool IsRequestAllowed(string ipAddress)\n    {\n        var now = DateTime.UtcNow;\n\n        _requests.AddOrUpdate(\n            ipAddress,\n            (now, 1),\n            (key, value) =&gt;\n            {\n                var (time, count) = value;\n                if (now - time &gt; TimeWindow)\n                    return (now, 1);\n                return (time, count + 1);\n            }\n        );\n\n        var (_, requestCount) = _requests[ipAddress];\n        return requestCount &lt;= MaxRequests;\n    }\n}\n</code></pre> <p>Enregistrement :</p> <pre><code>// Dans Program.cs\napp.UseMiddleware&lt;RateLimitingMiddleware&gt;();\n</code></pre>"},{"location":"api/middlewares/#ordre-dexecution","title":"Ordre d'ex\u00e9cution","text":"<p>L'ordre des middlewares est crucial :</p> <pre><code>var app = builder.Build();\n\n// 1. Exception handling en premier pour capturer toutes les erreurs\napp.UseMiddleware&lt;ExceptionHandlingMiddleware&gt;();\n\n// 2. HTTPS redirection\nif (app.Environment.IsDevelopment())\n{\n    app.UseSwagger();\n    app.UseSwaggerUI();\n}\n\n// 3. Redirection HTTPS\napp.UseHttpsRedirection();\n\n// 4. Rate limiting\napp.UseMiddleware&lt;RateLimitingMiddleware&gt;();\n\n// 5. Authorization\napp.UseAuthorization();\n\n// 6. Controllers (fin du pipeline)\napp.MapControllers();\n\napp.Run();\n</code></pre>"},{"location":"api/middlewares/#flow-de-requete","title":"Flow de requ\u00eate","text":"<pre><code>sequenceDiagram\n    participant C as Client\n    participant E as ExceptionMiddleware\n    participant R as RateLimitMiddleware\n    participant CTRL as Controller\n\n    C-&gt;&gt;E: Requ\u00eate HTTP\n    E-&gt;&gt;R: try { next() }\n    R-&gt;&gt;R: V\u00e9rifier limite\n    alt Limite d\u00e9pass\u00e9e\n        R--&gt;&gt;C: 429 Too Many Requests\n    else OK\n        R-&gt;&gt;CTRL: Continuer\n        CTRL-&gt;&gt;CTRL: Traiter requ\u00eate\n        alt Exception lev\u00e9e\n            CTRL-&gt;&gt;E: throw Exception\n            E-&gt;&gt;E: HandleException\n            E--&gt;&gt;C: 500/400/404 + JSON\n        else Succ\u00e8s\n            CTRL--&gt;&gt;C: 200 OK + Donn\u00e9es\n        end\n    end</code></pre>"},{"location":"api/middlewares/#gestion-des-exceptions-par-type","title":"Gestion des exceptions par type","text":""},{"location":"api/middlewares/#notfoundexception","title":"NotFoundException","text":"<pre><code>// Lev\u00e9e par les services\nthrow new ProductNotFoundException(productId);\n\n// Transform\u00e9e par le middleware\n// \u2192 404 Not Found\n{\n  \"message\": \"Produit avec l'ID '...' introuvable\"\n}\n</code></pre>"},{"location":"api/middlewares/#validationexception","title":"ValidationException","text":"<pre><code>// Lev\u00e9e par les services ou le domain\nthrow new ValidationException(\"Le prix doit \u00eatre strictement positif\");\n\n// Transform\u00e9e par le middleware\n// \u2192 400 Bad Request\n{\n  \"message\": \"Le prix doit \u00eatre strictement positif\"\n}\n</code></pre>"},{"location":"api/middlewares/#exception-generique","title":"Exception g\u00e9n\u00e9rique","text":"<pre><code>// Exception non g\u00e9r\u00e9e\nthrow new InvalidOperationException(\"Erreur inattendue\");\n\n// Transform\u00e9e par le middleware\n// \u2192 500 Internal Server Error\n{\n  \"message\": \"Une erreur interne est survenue\",\n  \"details\": null  // En production\n}\n</code></pre>"},{"location":"api/middlewares/#logging","title":"Logging","text":"<p>Le middleware log toutes les exceptions :</p> <pre><code>_logger.LogError(ex, \"Une erreur s'est produite lors du traitement de la requ\u00eate\");\n</code></pre> <p>Niveaux de log : - <code>LogError</code> : Exceptions inattendues (500) - <code>LogWarning</code> : Erreurs m\u00e9tier (404, 400) - <code>LogInformation</code> : Rate limiting d\u00e9pass\u00e9 (429)</p>"},{"location":"api/middlewares/#environnement-development-vs-production","title":"Environnement Development vs Production","text":""},{"location":"api/middlewares/#development","title":"Development","text":"<pre><code>{\n  \"message\": \"Produit introuvable\",\n  \"details\": \"   at ProductService.GetByIdAsync(...)\\n   at ProductController.GetById(...)\"\n}\n</code></pre>"},{"location":"api/middlewares/#production","title":"Production","text":"<pre><code>{\n  \"message\": \"Produit introuvable\",\n  \"details\": null\n}\n</code></pre> <p>S\u00e9curit\u00e9 : Les stack traces ne sont jamais expos\u00e9es en production.</p>"},{"location":"api/middlewares/#avantages-des-middlewares","title":"Avantages des middlewares","text":"Avantage Description \ud83c\udfaf S\u00e9paration des responsabilit\u00e9s Logique transversale isol\u00e9e \ud83d\udd04 R\u00e9utilisabilit\u00e9 Un middleware pour toute l'application \ud83e\uddea Testabilit\u00e9 Middlewares testables ind\u00e9pendamment \ud83d\udee1\ufe0f S\u00e9curit\u00e9 Gestion coh\u00e9rente des erreurs et limitations"},{"location":"api/middlewares/#best-practices","title":"Best practices","text":""},{"location":"api/middlewares/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Placer <code>ExceptionHandlingMiddleware</code> en premier</li> <li>Logger toutes les exceptions</li> <li>Masquer les d\u00e9tails techniques en production</li> <li>Utiliser des exceptions typ\u00e9es</li> </ul>"},{"location":"api/middlewares/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li><code>try-catch</code> dans chaque controller</li> <li>Exposer les stack traces en production</li> <li>Middlewares avec logique m\u00e9tier</li> <li>Ignorer les exceptions</li> </ul>"},{"location":"api/middlewares/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'API \u2192</li> <li>Controllers \u2192</li> <li>Endpoints \u2192</li> </ul>"},{"location":"application/dtos/","title":"DTOs","text":""},{"location":"application/dtos/#application-dtos-data-transfer-objects","title":"Application - DTOs (Data Transfer Objects)","text":""},{"location":"application/dtos/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les DTOs sont des objets simples utilis\u00e9s pour transf\u00e9rer des donn\u00e9es entre les couches de l'application.</p>"},{"location":"application/dtos/#pourquoi-des-dtos","title":"Pourquoi des DTOs ?","text":"<ol> <li>Isolation du Domain : Les entit\u00e9s ne sont pas expos\u00e9es directement</li> <li>Simplicit\u00e9 : Structures plates, faciles \u00e0 s\u00e9rialiser</li> <li>Versioning : Possibilit\u00e9 d'avoir plusieurs versions d'API</li> <li>Performance : S\u00e9lection des champs n\u00e9cessaires uniquement</li> </ol>"},{"location":"application/dtos/#structure","title":"Structure","text":"<pre><code>DTOs/\n\u251c\u2500\u2500 Common/            # DTOs partag\u00e9s\n\u251c\u2500\u2500 Products/          # DTOs produits\n\u2502   \u251c\u2500\u2500 ProductDto.cs\n\u2502   \u251c\u2500\u2500 CreateProductDto.cs\n\u2502   \u2514\u2500\u2500 UpdateProductDto.cs\n\u251c\u2500\u2500 Suppliers/         # DTOs fournisseurs\n\u251c\u2500\u2500 Users/             # DTOs utilisateurs\n\u2514\u2500\u2500 Orders/            # DTOs commandes\n</code></pre>"},{"location":"application/dtos/#dtos-products","title":"DTOs Products","text":""},{"location":"application/dtos/#productdto","title":"ProductDto","text":"<p>DTO de retour pour un produit.</p> <pre><code>/// &lt;summary&gt;\n/// Repr\u00e9sente un produit du catalogue\n/// &lt;/summary&gt;\npublic record ProductDto(\n    Guid Id,\n    string Name,\n    string Description,\n    decimal Price,\n    decimal VatRate,\n    bool IsActive,\n    Guid SupplierId\n);\n</code></pre>"},{"location":"application/dtos/#createproductdto","title":"CreateProductDto","text":"<p>DTO pour cr\u00e9er un nouveau produit.</p> <pre><code>/// &lt;summary&gt;\n/// Donn\u00e9es n\u00e9cessaires pour cr\u00e9er un produit\n/// &lt;/summary&gt;\npublic record CreateProductDto(\n    [Required] string Name,\n    [StringLength(500)] string Description,\n    [Range(0.01, double.MaxValue)] decimal Price,\n    [Range(0, 100)] decimal VatRate,\n    Guid SupplierId\n);\n</code></pre>"},{"location":"application/dtos/#updateproductdto","title":"UpdateProductDto","text":"<p>DTO pour mettre \u00e0 jour un produit.</p> <pre><code>/// &lt;summary&gt;\n/// Donn\u00e9es pour mettre \u00e0 jour un produit\n/// &lt;/summary&gt;\npublic record UpdateProductDto(\n    string? Name,\n    string? Description,\n    decimal? Price,\n    decimal? VatRate,\n    bool? IsActive\n);\n</code></pre>"},{"location":"application/dtos/#dtos-suppliers","title":"DTOs Suppliers","text":"<pre><code>public record SupplierDto(\n    Guid Id,\n    string Name,\n    string Email,\n    string Phone\n);\n\npublic record CreateSupplierDto(\n    [Required] string Name,\n    [Required][EmailAddress] string Email,\n    [Phone] string Phone\n);\n\npublic record UpdateSupplierDto(\n    string? Name,\n    string? Email,\n    string? Phone\n);\n</code></pre>"},{"location":"application/dtos/#dtos-users","title":"DTOs Users","text":"<pre><code>public record UserDto(\n    Guid Id,\n    string FirstName,\n    string LastName,\n    string Email\n);\n\npublic record CreateUserDto(\n    [Required] string FirstName,\n    [Required] string LastName,\n    [Required][EmailAddress] string Email\n);\n\npublic record UpdateUserDto(\n    string? FirstName,\n    string? LastName,\n    string? Email\n);\n</code></pre>"},{"location":"application/dtos/#dtos-orders","title":"DTOs Orders","text":""},{"location":"application/dtos/#orderdto","title":"OrderDto","text":"<pre><code>public record OrderDto(\n    Guid Id,\n    Guid UserId,\n    DateTime OrderDate,\n    IEnumerable&lt;OrderLineDto&gt; OrderLines,\n    decimal TotalAmount\n);\n</code></pre>"},{"location":"application/dtos/#createorderdto","title":"CreateOrderDto","text":"<pre><code>public record CreateOrderDto(\n    Guid UserId,\n    DateTime OrderDate,\n    IEnumerable&lt;CreateOrderLineDto&gt; OrderLines\n);\n</code></pre>"},{"location":"application/dtos/#orderlinedto","title":"OrderLineDto","text":"<pre><code>public record OrderLineDto(\n    Guid Id,\n    Guid ProductId,\n    int Quantity,\n    decimal UnitPrice\n);\n\npublic record CreateOrderLineDto(\n    Guid ProductId,\n    [Range(1, int.MaxValue)] int Quantity,\n    [Range(0.01, double.MaxValue)] decimal UnitPrice\n);\n</code></pre>"},{"location":"application/dtos/#records-vs-classes","title":"Records vs Classes","text":""},{"location":"application/dtos/#records-recommande-pour-dtos","title":"Records (recommand\u00e9 pour DTOs)","text":"<pre><code>// Immutable par d\u00e9faut\npublic record ProductDto(Guid Id, string Name, decimal Price);\n\n// \u00c9galit\u00e9 par valeur automatique\nvar dto1 = new ProductDto(id, \"Laptop\", 1000);\nvar dto2 = new ProductDto(id, \"Laptop\", 1000);\nConsole.WriteLine(dto1 == dto2);  // True\n\n// with expression pour copie modifi\u00e9e\nvar dto3 = dto1 with { Price = 1200 };\n</code></pre>"},{"location":"application/dtos/#classes-si-necessaire","title":"Classes (si n\u00e9cessaire)","text":"<pre><code>public class ProductDto\n{\n    public Guid Id { get; set; }\n    public string Name { get; set; }\n    public decimal Price { get; set; }\n}\n</code></pre>"},{"location":"application/dtos/#validation-avec-data-annotations","title":"Validation avec Data Annotations","text":"<pre><code>public record CreateProductDto(\n    [Required(ErrorMessage = \"Le nom est requis\")]\n    [StringLength(100, MinimumLength = 3, ErrorMessage = \"Le nom doit contenir entre 3 et 100 caract\u00e8res\")]\n    string Name,\n\n    [StringLength(500, ErrorMessage = \"La description ne peut pas d\u00e9passer 500 caract\u00e8res\")]\n    string Description,\n\n    [Required]\n    [Range(0.01, double.MaxValue, ErrorMessage = \"Le prix doit \u00eatre strictement positif\")]\n    decimal Price,\n\n    [Required]\n    [Range(0, 100, ErrorMessage = \"Le taux de TVA doit \u00eatre entre 0 et 100\")]\n    decimal VatRate,\n\n    [Required]\n    Guid SupplierId\n);\n</code></pre>"},{"location":"application/dtos/#mapping-entity-dto","title":"Mapping Entity \u2194 DTO","text":""},{"location":"application/dtos/#manuellement-dans-les-services","title":"Manuellement (dans les services)","text":"<pre><code>// Entity \u2192 DTO\nprivate static ProductDto MapToDto(Product product)\n{\n    return new ProductDto(\n        product.Id,\n        product.Name,\n        product.Description,\n        product.Price.Value,\n        product.Vat.Rate,\n        product.IsActive,\n        product.SupplierId\n    );\n}\n\n// DTO \u2192 Entity\nprivate static Product MapToEntity(CreateProductDto dto)\n{\n    return new Product(\n        dto.Name,\n        dto.Description,\n        new Price(dto.Price),\n        new VAT(dto.VatRate),\n        dto.SupplierId\n    );\n}\n</code></pre>"},{"location":"application/dtos/#avec-automapper-optionnel","title":"Avec AutoMapper (optionnel)","text":"<pre><code>// Configuration\nCreateMap&lt;Product, ProductDto&gt;()\n    .ForMember(dest =&gt; dest.Price, opt =&gt; opt.MapFrom(src =&gt; src.Price.Value))\n    .ForMember(dest =&gt; dest.VatRate, opt =&gt; opt.MapFrom(src =&gt; src.Vat.Rate));\n\n// Utilisation\nvar dto = _mapper.Map&lt;ProductDto&gt;(product);\n</code></pre>"},{"location":"application/dtos/#dtos-vs-entities","title":"DTOs vs Entities","text":"DTO Entity Transfert de donn\u00e9es Logique m\u00e9tier Structure plate Structure riche Pas de comportement Comportements m\u00e9tier S\u00e9rialisable JSON Pas n\u00e9cessairement s\u00e9rialisable Validation de forme Validation m\u00e9tier"},{"location":"application/dtos/#pattern-cqrs-optionnel","title":"Pattern CQRS (optionnel)","text":"<p>S\u00e9paration des DTOs de lecture et d'\u00e9criture :</p> <pre><code>// Commandes (\u00e9criture)\npublic record CreateProductCommand(string Name, decimal Price);\npublic record UpdateProductCommand(Guid Id, decimal Price);\n\n// Queries (lecture)\npublic record ProductQuery(Guid Id);\npublic record ProductListQuery(int PageSize, int PageNumber);\n\n// R\u00e9sultats\npublic record ProductResult(Guid Id, string Name, decimal Price);\n</code></pre>"},{"location":"application/dtos/#best-practices","title":"Best Practices","text":""},{"location":"application/dtos/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Utiliser des records pour l'immuabilit\u00e9</li> <li>Ajouter des attributs de validation</li> <li>Documenter avec des commentaires XML</li> <li>Cr\u00e9er des DTOs sp\u00e9cifiques par op\u00e9ration (Create, Update, etc.)</li> </ul>"},{"location":"application/dtos/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Exposer directement les entit\u00e9s Domain</li> <li>DTOs avec logique m\u00e9tier</li> <li>DTOs mutables si non n\u00e9cessaire</li> <li>R\u00e9utiliser le m\u00eame DTO pour toutes les op\u00e9rations</li> </ul>"},{"location":"application/dtos/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 Application \u2192</li> <li>Services \u2192</li> <li>Validation (API) \u2192</li> </ul>"},{"location":"application/exceptions/","title":"Exceptions","text":""},{"location":"application/exceptions/#application-exceptions","title":"Application - Exceptions","text":""},{"location":"application/exceptions/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les exceptions applicatives sont lev\u00e9es par les services lorsqu'une erreur se produit au niveau de la couche Application.</p>"},{"location":"application/exceptions/#applicationserviceexception","title":"ApplicationServiceException","text":"<p>Exception de base pour la couche Application.</p> <pre><code>/// &lt;summary&gt;\n/// Exception lev\u00e9e par les services applicatifs\n/// &lt;/summary&gt;\npublic class ApplicationServiceException : Exception\n{\n    public ApplicationServiceException(string message) \n        : base(message)\n    {\n    }\n\n    public ApplicationServiceException(string message, Exception innerException) \n        : base(message, innerException)\n    {\n    }\n}\n</code></pre>"},{"location":"application/exceptions/#utilisation","title":"Utilisation","text":""},{"location":"application/exceptions/#wrapper-dexceptions-inattendues","title":"Wrapper d'exceptions inattendues","text":"<pre><code>public async Task&lt;ProductDto&gt; GetByIdAsync(Guid id)\n{\n    try\n    {\n        var product = await _repository.GetByIdAsync(id);\n        if (product == null)\n            throw new ProductNotFoundException(id);  // Exception Domain\n\n        return MapToDto(product);\n    }\n    catch (DomainException)\n    {\n        // Propager les exceptions m\u00e9tier\n        throw;\n    }\n    catch (Exception ex)\n    {\n        // Wrapper les autres exceptions\n        throw new ApplicationServiceException(\n            $\"Erreur lors de la r\u00e9cup\u00e9ration du produit {id}\", \n            ex\n        );\n    }\n}\n</code></pre>"},{"location":"application/exceptions/#validation-au-niveau-application","title":"Validation au niveau application","text":"<pre><code>public async Task&lt;OrderDto&gt; CreateAsync(CreateOrderDto dto)\n{\n    // Validation m\u00e9tier de haut niveau\n    if (!dto.OrderLines.Any())\n    {\n        throw new ApplicationServiceException(\n            \"Une commande doit contenir au moins une ligne\"\n        );\n    }\n\n    // V\u00e9rification de l'existence de l'utilisateur\n    var user = await _userRepository.GetByIdAsync(dto.UserId);\n    if (user == null)\n    {\n        throw new ApplicationServiceException(\n            $\"L'utilisateur {dto.UserId} n'existe pas\"\n        );\n    }\n\n    // ...\n}\n</code></pre>"},{"location":"application/exceptions/#hierarchie-des-exceptions","title":"Hi\u00e9rarchie des exceptions","text":"<pre><code>graph TB\n    EX[Exception .NET] --&gt; APPEX[ApplicationServiceException]\n    EX --&gt; DOMEX[DomainException]\n\n    DOMEX --&gt; PRICE[InvalidPriceException]\n    DOMEX --&gt; NOTFOUND[ProductNotFoundException]\n\n    style APPEX fill:#2196F3,color:#fff\n    style DOMEX fill:#4CAF50,color:#fff</code></pre>"},{"location":"application/exceptions/#flow-des-exceptions","title":"Flow des exceptions","text":"<pre><code>sequenceDiagram\n    participant C as Controller\n    participant S as Service (Application)\n    participant D as Domain\n    participant M as Middleware\n\n    C-&gt;&gt;S: CreateProduct(dto)\n\n    alt Exception Domain\n        S-&gt;&gt;D: new Price(-50)\n        D--&gt;&gt;S: throw InvalidPriceException\n        S--&gt;&gt;C: throw InvalidPriceException\n    else Exception Application\n        S-&gt;&gt;S: Validation\n        S--&gt;&gt;C: throw ApplicationServiceException\n    end\n\n    C--&gt;&gt;M: Exception propag\u00e9e\n    M-&gt;&gt;M: HandleException\n    M--&gt;&gt;C: HTTP Response (400/500)</code></pre>"},{"location":"application/exceptions/#gestion-par-le-middleware","title":"Gestion par le middleware","text":"<p>Le <code>ExceptionHandlingMiddleware</code> g\u00e8re toutes les exceptions :</p> <pre><code>private static Task HandleExceptionAsync(HttpContext context, Exception exception)\n{\n    var statusCode = exception switch\n    {\n        // Exceptions Domain\n        ProductNotFoundException =&gt; StatusCodes.Status404NotFound,\n        InvalidPriceException =&gt; StatusCodes.Status400BadRequest,\n        DomainException =&gt; StatusCodes.Status400BadRequest,\n\n        // Exceptions Application\n        ApplicationServiceException =&gt; StatusCodes.Status500InternalServerError,\n\n        // Autres\n        _ =&gt; StatusCodes.Status500InternalServerError\n    };\n\n    context.Response.StatusCode = statusCode;\n\n    return context.Response.WriteAsJsonAsync(new\n    {\n        message = exception.Message,\n        details = IsDevelopment ? exception.StackTrace : null\n    });\n}\n</code></pre>"},{"location":"application/exceptions/#types-dexceptions-par-couche","title":"Types d'exceptions par couche","text":"Couche Exception Exemple Domain DomainException InvalidPriceException Application ApplicationServiceException \"Commande vide\" Infrastructure RepositoryException Erreur base de donn\u00e9es API - Pas d'exception custom (middleware)"},{"location":"application/exceptions/#best-practices","title":"Best Practices","text":""},{"location":"application/exceptions/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Propager les exceptions Domain sans les wrapper</li> <li>Logger les exceptions avant de les relancer</li> <li>Wrapper uniquement les exceptions inattendues</li> <li>Fournir un contexte dans le message d'erreur</li> </ul> <pre><code>catch (Exception ex)\n{\n    _logger.LogError(ex, \"Erreur lors de la cr\u00e9ation du produit\");\n    throw new ApplicationServiceException(\n        \"Impossible de cr\u00e9er le produit\", \n        ex\n    );\n}\n</code></pre>"},{"location":"application/exceptions/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Capturer et ignorer les exceptions</li> <li>Wrapper les exceptions m\u00e9tier (Domain)</li> <li>Messages d'erreur g\u00e9n\u00e9riques</li> <li>Logique m\u00e9tier dans les catch</li> </ul>"},{"location":"application/exceptions/#logging","title":"Logging","text":"<p>Les services doivent logger les erreurs :</p> <pre><code>public class ProductService\n{\n    private readonly ILogger&lt;ProductService&gt; _logger;\n    private readonly IProductRepository _repository;\n\n    public async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n    {\n        try\n        {\n            _logger.LogInformation(\"Cr\u00e9ation d'un nouveau produit: {Name}\", dto.Name);\n\n            var product = new Product(/* ... */);\n            await _repository.AddAsync(product);\n\n            _logger.LogInformation(\"Produit cr\u00e9\u00e9 avec succ\u00e8s: {Id}\", product.Id);\n            return MapToDto(product);\n        }\n        catch (Exception ex)\n        {\n            _logger.LogError(ex, \"Erreur lors de la cr\u00e9ation du produit {Name}\", dto.Name);\n            throw;\n        }\n    }\n}\n</code></pre>"},{"location":"application/exceptions/#exemples-dutilisation","title":"Exemples d'utilisation","text":""},{"location":"application/exceptions/#validation-de-regles-metier-complexes","title":"Validation de r\u00e8gles m\u00e9tier complexes","text":"<pre><code>public async Task&lt;OrderDto&gt; CreateAsync(CreateOrderDto dto)\n{\n    // R\u00e8gle: Une commande doit avoir au moins une ligne\n    if (!dto.OrderLines.Any())\n        throw new ApplicationServiceException(\"Une commande doit contenir au moins une ligne\");\n\n    // R\u00e8gle: L'utilisateur doit exister\n    var user = await _userRepository.GetByIdAsync(dto.UserId);\n    if (user == null)\n        throw new ApplicationServiceException($\"L'utilisateur {dto.UserId} n'existe pas\");\n\n    // R\u00e8gle: Tous les produits doivent exister\n    foreach (var line in dto.OrderLines)\n    {\n        var product = await _productRepository.GetByIdAsync(line.ProductId);\n        if (product == null)\n            throw new ApplicationServiceException($\"Le produit {line.ProductId} n'existe pas\");\n    }\n\n    // Cr\u00e9ation de la commande\n    // ...\n}\n</code></pre>"},{"location":"application/exceptions/#wrapper-dexceptions-infrastructure","title":"Wrapper d'exceptions infrastructure","text":"<pre><code>public async Task&lt;ProductDto&gt; UpdateAsync(Guid id, UpdateProductDto dto)\n{\n    try\n    {\n        var product = await _repository.GetByIdAsync(id);\n        if (product == null)\n            throw new ProductNotFoundException(id);\n\n        // Mise \u00e0 jour\n        await _repository.UpdateAsync(product);\n\n        return MapToDto(product);\n    }\n    catch (DomainException)\n    {\n        // Propager les exceptions m\u00e9tier\n        throw;\n    }\n    catch (DbUpdateException ex)\n    {\n        // Wrapper les exceptions EF Core\n        throw new ApplicationServiceException(\"Erreur lors de la mise \u00e0 jour en base de donn\u00e9es\", ex);\n    }\n}\n</code></pre>"},{"location":"application/exceptions/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 Application \u2192</li> <li>Services \u2192</li> <li>Exceptions Domain \u2192</li> <li>Middleware Exception Handling \u2192</li> </ul>"},{"location":"application/services/","title":"Services","text":""},{"location":"application/services/#application-services","title":"Application - Services","text":"<ul> <li>Exceptions \u2192</li> <li>DTOs \u2192</li> <li>Retour \u00e0 Application \u2192</li> </ul>"},{"location":"application/services/#navigation","title":"Navigation","text":"<pre><code>}\n    }\n        );\n            () =&gt; service.CreateAsync(dto)\n        await Assert.ThrowsAsync&lt;InvalidPriceException&gt;(\n        // Act &amp; Assert\n\n        var dto = new CreateProductDto(\"Laptop\", \"HP\", -100, 20, Guid.NewGuid());\n        var service = new ProductService(mockRepo.Object);\n        var mockRepo = new Mock&lt;IProductRepository&gt;();\n        // Arrange\n    {\n    public async Task CreateAsync_WithNegativePrice_ShouldThrowException()\n    [Fact]\n\n    }\n        mockRepo.Verify(r =&gt; r.AddAsync(It.IsAny&lt;Product&gt;()), Times.Once);\n        Assert.Equal(\"Laptop\", result.Name);\n        Assert.NotNull(result);\n        // Assert\n\n        var result = await service.CreateAsync(dto);\n        // Act\n\n        var dto = new CreateProductDto(\"Laptop\", \"HP\", 1000, 20, Guid.NewGuid());\n        var service = new ProductService(mockRepo.Object);\n        var mockRepo = new Mock&lt;IProductRepository&gt;();\n        // Arrange\n    {\n    public async Task CreateAsync_WithValidData_ShouldReturnProductDto()\n    [Fact]\n{\npublic class ProductServiceTests\n```csharp\n\n## Tests des services\n</code></pre> }     }         throw;         // Propager les exceptions m\u00e9tier     {     catch (DomainException)     }         return MapToDto(product);         await _productRepository.UpdateAsync(product); <pre><code>    product.UpdatePrice(newPrice);\n    var newPrice = new Price(dto.Price);  // Peut lever InvalidPriceException\n    // La validation est dans Price\n{\ntry\n\n    throw new ProductNotFoundException(id);\nif (product == null)\n// Not Found\n\nvar product = await _productRepository.GetByIdAsync(id);\n</code></pre> <p>{ public async Task UpdateAsync(Guid id, UpdateProductDto dto) ```csharp  Les services propagent les exceptions du Domain : </p>"},{"location":"application/services/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<p>``` }     return MapToDto(product);     await _productRepository.AddAsync(product);</p> <pre><code>);\n    dto.SupplierId\n    vat,\n    price,\n    dto.Description,\n    dto.Name,\nvar product = new Product(\n// Cr\u00e9ation de l'entit\u00e9\n\nvar vat = new VAT(dto.VatRate);\nvar price = new Price(dto.Price);\n// Reconstruction des Value Objects\n</code></pre> <p>{ public async Task CreateAsync(CreateProductDto dto) ```csharp </p>"},{"location":"application/services/#dto-entity-ecriture","title":"DTO \u2192 Entity (\u00e9criture)","text":"<p><code>}     );         product.SupplierId         product.IsActive,         product.Vat.Rate,         // Extraction du taux         product.Price.Value,     // Extraction de la valeur         product.Description,         product.Name,         product.Id,     return new ProductDto( { private static ProductDto MapToDto(Product product)</code>csharp </p>"},{"location":"application/services/#entity-dto-lecture","title":"Entity \u2192 DTO (lecture)","text":""},{"location":"application/services/#mapping-entity-dto","title":"Mapping Entity \u2194 DTO","text":"<p>```     SVC --&gt;|Utilise| VO[Value Object]     SVC --&gt;|Cr\u00e9e| DTO[DTO]</p> <pre><code>SVC --&gt; REPO[IRepository]\nSVC --&gt; ENT[Entity Domain]\nCTRL[Controller] --&gt; SVC[Service]\n</code></pre> <p>graph TB ```mermaid </p>"},{"location":"application/services/#pattern-utilise-service-layer","title":"Pattern utilis\u00e9 : Service Layer","text":"<ol> <li>Application des r\u00e8gles m\u00e9tier de haut niveau</li> <li>Coordination de transactions complexes</li> <li>Transformation Entity \u2194 DTO</li> <li>Orchestration des entit\u00e9s et repositories</li> <li>Validation m\u00e9tier (en compl\u00e9ment de la validation Domain)  Les services sont responsables de : </li> </ol>"},{"location":"application/services/#responsabilites","title":"Responsabilit\u00e9s","text":"<p>``` }     public async Task&gt; GetByUserIdAsync(Guid userId);     // M\u00e9thodes sp\u00e9cifiques</p> <pre><code>public async Task DeleteAsync(Guid id);\npublic async Task&lt;OrderDto&gt; UpdateAsync(Guid id, UpdateOrderDto dto);\npublic async Task&lt;OrderDto&gt; CreateAsync(CreateOrderDto dto);\npublic async Task&lt;OrderDto?&gt; GetByIdAsync(Guid id);\npublic async Task&lt;IEnumerable&lt;OrderDto&gt;&gt; GetAllAsync();\n\nprivate readonly IUserRepository _userRepository;\nprivate readonly IProductRepository _productRepository;\nprivate readonly IOrderRepository _orderRepository;\n</code></pre> <p>{ public class OrderService ```csharp  Gestion des commandes avec lignes de commande. </p>"},{"location":"application/services/#orderservice","title":"OrderService","text":"<p>``` }     public async Task DeleteAsync(Guid id);     public async Task UpdateAsync(Guid id, UpdateUserDto dto);     public async Task CreateAsync(CreateUserDto dto);     public async Task GetByIdAsync(Guid id);     public async Task&gt; GetAllAsync();</p> <pre><code>private readonly IUserRepository _userRepository;\n</code></pre> <p>{ public class UserService ```csharp  Gestion des utilisateurs. </p>"},{"location":"application/services/#userservice","title":"UserService","text":"<p>``` }     public async Task DeleteAsync(Guid id);     public async Task UpdateAsync(Guid id, UpdateSupplierDto dto);     public async Task CreateAsync(CreateSupplierDto dto);     public async Task GetByIdAsync(Guid id);     public async Task&gt; GetAllAsync();</p> <pre><code>private readonly ISupplierRepository _supplierRepository;\n</code></pre> <p>{ public class SupplierService ```csharp  Gestion des fournisseurs. </p>"},{"location":"application/services/#supplierservice","title":"SupplierService","text":"<p>``` }     }         );             product.SupplierId             product.IsActive,             product.Vat.Rate,             product.Price.Value,             product.Description,             product.Name,             product.Id,         return new ProductDto(     {     private static ProductDto MapToDto(Product product)     // Mapping Entity \u2192 DTO</p> <pre><code>}\n    await _productRepository.DeleteAsync(id);\n\n        throw new ProductNotFoundException(id);\n    if (product == null)\n    var product = await _productRepository.GetByIdAsync(id);\n{\npublic async Task DeleteAsync(Guid id)\n/// &lt;/summary&gt;\n/// Supprime un produit\n/// &lt;summary&gt;\n\n}\n    return MapToDto(product);\n    await _productRepository.UpdateAsync(product);\n\n    }\n        product.UpdatePrice(newPrice);\n        var newPrice = new Price(dto.Price.Value);\n    {\n    if (dto.Price.HasValue)\n    // Mise \u00e0 jour via m\u00e9thodes m\u00e9tier\n\n        throw new ProductNotFoundException(id);\n    if (product == null)\n    var product = await _productRepository.GetByIdAsync(id);\n{\npublic async Task&lt;ProductDto&gt; UpdateAsync(Guid id, UpdateProductDto dto)\n/// &lt;/summary&gt;\n/// Met \u00e0 jour un produit existant\n/// &lt;summary&gt;\n\n}\n    return MapToDto(product);\n    // Retourner le DTO\n\n    await _productRepository.AddAsync(product);\n    // Persister\n\n    );\n        dto.SupplierId\n        vat,\n        price,\n        dto.Description,\n        dto.Name,\n    var product = new Product(\n    // Cr\u00e9er l'entit\u00e9 Domain\n\n    var vat = new VAT(dto.VatRate);\n    var price = new Price(dto.Price);\n    // Cr\u00e9er les Value Objects\n{\npublic async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n/// &lt;/summary&gt;\n/// Cr\u00e9e un nouveau produit\n/// &lt;summary&gt;\n\n}\n    return product != null ? MapToDto(product) : null;\n    var product = await _productRepository.GetByIdAsync(id);\n{\npublic async Task&lt;ProductDto?&gt; GetByIdAsync(Guid id)\n/// &lt;/summary&gt;\n/// R\u00e9cup\u00e8re un produit par son identifiant\n/// &lt;summary&gt;\n\n}\n    return products.Select(MapToDto);\n    var products = await _productRepository.GetAllAsync();\n{\npublic async Task&lt;IEnumerable&lt;ProductDto&gt;&gt; GetAllAsync()\n/// &lt;/summary&gt;\n/// R\u00e9cup\u00e8re tous les produits du catalogue\n/// &lt;summary&gt;\n\n}\n    _productRepository = productRepository;\n{\npublic ProductService(IProductRepository productRepository)\n\nprivate readonly IProductRepository _productRepository;\n</code></pre> <p>{ public class ProductService ```csharp</p> <p>Gestion compl\u00e8te du catalogue produits.</p>"},{"location":"application/services/#productservice","title":"ProductService","text":""},{"location":"application/services/#services-disponibles","title":"Services disponibles","text":"<p>Les services applicatifs orchestrent la logique m\u00e9tier en coordonnant les entit\u00e9s du Domain et les repositories.</p>"},{"location":"application/services/#vue-densemble","title":"Vue d'ensemble","text":""},{"location":"architecture/api/","title":"API","text":""},{"location":"architecture/api/#api-layer-couche-presentation","title":"API Layer - Couche Pr\u00e9sentation","text":""},{"location":"architecture/api/#vue-densemble","title":"Vue d'ensemble","text":"<p>La couche API est le point d'entr\u00e9e de l'application. Elle expose les fonctionnalit\u00e9s via des endpoints HTTP REST.</p>"},{"location":"architecture/api/#responsabilites","title":"Responsabilit\u00e9s","text":"<ul> <li>\u2705 Exposer des endpoints REST (GET, POST, PUT, DELETE)</li> <li>\u2705 Recevoir et valider les requ\u00eates HTTP</li> <li>\u2705 Appeler les services Application</li> <li>\u2705 Transformer les r\u00e9sultats en r\u00e9ponses HTTP</li> <li>\u2705 G\u00e9rer les middlewares (erreurs, logging, rate limiting)</li> </ul>"},{"location":"architecture/api/#structure","title":"Structure","text":"<pre><code>API/\n\u251c\u2500\u2500 Controllers/        # Controllers REST\n\u2502   \u251c\u2500\u2500 ProductController.cs\n\u2502   \u251c\u2500\u2500 SupplierController.cs\n\u2502   \u251c\u2500\u2500 UserController.cs\n\u2502   \u2514\u2500\u2500 OrderController.cs\n\u251c\u2500\u2500 Middlewares/       # Middlewares personnalis\u00e9s\n\u2502   \u2514\u2500\u2500 ExceptionHandlingMiddleware.cs\n\u251c\u2500\u2500 Program.cs         # Configuration de l'application\n\u2514\u2500\u2500 appsettings.json   # Configuration\n</code></pre>"},{"location":"architecture/api/#diagramme-des-dependances","title":"Diagramme des d\u00e9pendances","text":"<pre><code>graph TB\n    CLIENT[Client HTTP] --&gt;|Request| CTRL[Controller]\n    CTRL --&gt; SVC[Application Service]\n    SVC --&gt; DOM[Domain]\n    SVC --&gt; REPO[IRepository]\n    INF[Infrastructure] -.-&gt;|Impl\u00e9mente| REPO\n    CTRL --&gt;|Response| CLIENT\n\n    style CTRL fill:#FF9800,color:#fff</code></pre>"},{"location":"architecture/api/#controllers","title":"Controllers","text":""},{"location":"architecture/api/#role","title":"R\u00f4le","text":"<p>Les controllers : 1. Re\u00e7oivent les requ\u00eates HTTP 2. Valident les donn\u00e9es (ModelState) 3. Appellent les services 4. Retournent des r\u00e9ponses HTTP</p> <pre><code>[ApiController]\n[Route(\"api/[controller]\")]\npublic class ProductController : ControllerBase\n{\n    private readonly ProductService _service;\n\n    [HttpGet]\n    public async Task&lt;ActionResult&lt;IEnumerable&lt;ProductDto&gt;&gt;&gt; GetAll()\n    {\n        var products = await _service.GetAllAsync();\n        return Ok(products);\n    }\n\n    [HttpPost]\n    public async Task&lt;ActionResult&lt;ProductDto&gt;&gt; Create(CreateProductDto dto)\n    {\n        var product = await _service.CreateAsync(dto);\n        return CreatedAtAction(nameof(GetById), new { id = product.Id }, product);\n    }\n}\n</code></pre> <p>En savoir plus \u2192</p>"},{"location":"architecture/api/#middlewares","title":"Middlewares","text":""},{"location":"architecture/api/#exceptionhandlingmiddleware","title":"ExceptionHandlingMiddleware","text":"<p>Capture toutes les exceptions et retourne des r\u00e9ponses HTTP appropri\u00e9es :</p> <pre><code>public class ExceptionHandlingMiddleware\n{\n    public async Task InvokeAsync(HttpContext context)\n    {\n        try\n        {\n            await _next(context);\n        }\n        catch (Exception ex)\n        {\n            await HandleExceptionAsync(context, ex);\n        }\n    }\n}\n</code></pre> <p>Avantages : - \u2705 Gestion centralis\u00e9e des erreurs - \u2705 Pas de <code>try-catch</code> dans chaque controller - \u2705 R\u00e9ponses d'erreur coh\u00e9rentes</p> <p>En savoir plus \u2192</p>"},{"location":"architecture/api/#pipeline-http","title":"Pipeline HTTP","text":"<pre><code>graph LR\n    REQ[Requ\u00eate HTTP] --&gt; HTTPS[HttpsRedirection]\n    HTTPS --&gt; AUTH[Authorization]\n    AUTH --&gt; CTRL[Controllers]\n    CTRL --&gt; RES[R\u00e9ponse HTTP]</code></pre> <p>Configuration dans <code>Program.cs</code> :</p> <pre><code>app.UseHttpsRedirection();\napp.UseAuthorization();\napp.MapControllers();\n</code></pre>"},{"location":"architecture/api/#swagger-openapi","title":"Swagger / OpenAPI","text":"<p>Documentation automatique de l'API :</p> <pre><code>builder.Services.AddSwaggerGen(options =&gt;\n{\n    // Inclusion des commentaires XML\n    var xmlFiles = Directory.GetFiles(AppContext.BaseDirectory, \"*.xml\");\n    foreach (var xmlFile in xmlFiles)\n    {\n        options.IncludeXmlComments(xmlFile);\n    }\n});\n</code></pre> <p>Acc\u00e8s : <code>https://localhost:5181/swagger</code></p>"},{"location":"architecture/api/#validation","title":"Validation","text":""},{"location":"architecture/api/#validation-automatique-modelstate","title":"Validation automatique (ModelState)","text":"<pre><code>[HttpPost]\npublic async Task&lt;ActionResult&lt;ProductDto&gt;&gt; Create(CreateProductDto dto)\n{\n    // ASP.NET Core valide automatiquement le ModelState\n    if (!ModelState.IsValid)\n        return BadRequest(ModelState);\n\n    // ...\n}\n</code></pre>"},{"location":"architecture/api/#attributs-de-validation","title":"Attributs de validation","text":"<pre><code>public record CreateProductDto(\n    [Required] string Name,\n    [Range(0.01, double.MaxValue)] decimal Price,\n    [Range(0, 100)] decimal VatRate\n);\n</code></pre>"},{"location":"architecture/api/#codes-de-statut-http","title":"Codes de statut HTTP","text":"M\u00e9thode Succ\u00e8s Ressource cr\u00e9\u00e9e Pas trouv\u00e9 Erreur validation GET 200 OK - 404 - POST 200 OK 201 Created - 400 PUT 200 OK - 404 400 DELETE 204 - 404 -"},{"location":"architecture/api/#injection-de-dependances","title":"Injection de d\u00e9pendances","text":"<p>Dans <code>Program.cs</code> :</p> <pre><code>// Services applicatifs\nbuilder.Services.AddScoped&lt;ProductService&gt;();\nbuilder.Services.AddScoped&lt;SupplierService&gt;();\nbuilder.Services.AddScoped&lt;UserService&gt;();\nbuilder.Services.AddScoped&lt;OrderService&gt;();\n\n// Repositories\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\n// ...\n</code></pre>"},{"location":"architecture/api/#rate-limiting","title":"Rate Limiting","text":"<p>Protection contre les abus et DDoS :</p> <ul> <li>Limite : 100 requ\u00eates/minute par IP</li> <li>Impl\u00e9mentation : Middleware personnalis\u00e9</li> </ul> <pre><code>app.UseRateLimiting();\n</code></pre>"},{"location":"architecture/api/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"architecture/api/#https-obligatoire","title":"HTTPS obligatoire","text":"<pre><code>app.UseHttpsRedirection();\n</code></pre>"},{"location":"architecture/api/#validation-des-entrees","title":"Validation des entr\u00e9es","text":"<p>Toutes les entr\u00e9es utilisateur sont valid\u00e9es.</p>"},{"location":"architecture/api/#pas-de-details-techniques-en-production","title":"Pas de d\u00e9tails techniques en production","text":"<p>Les d\u00e9tails des exceptions ne sont expos\u00e9s qu'en d\u00e9veloppement.</p>"},{"location":"architecture/api/#flux-de-requete","title":"Flux de requ\u00eate","text":"<pre><code>sequenceDiagram\n    participant C as Client\n    participant CTRL as Controller\n    participant SVC as Service\n    participant REPO as Repository\n\n    C-&gt;&gt;CTRL: POST /api/products\n    CTRL-&gt;&gt;CTRL: Validate ModelState\n    CTRL-&gt;&gt;SVC: CreateAsync(dto)\n    SVC-&gt;&gt;REPO: AddAsync(entity)\n    REPO--&gt;&gt;SVC: void\n    SVC--&gt;&gt;CTRL: ProductDto\n    CTRL--&gt;&gt;C: 201 Created</code></pre>"},{"location":"architecture/api/#dependances","title":"D\u00e9pendances","text":"<pre><code>graph TB\n    API[API Layer]\n    APP[Application Layer]\n    INF[Infrastructure Layer]\n\n    API --&gt; APP\n    API -.-&gt;|Injection| INF\n\n    style API fill:#FF9800,color:#fff</code></pre>"},{"location":"architecture/api/#avantages","title":"Avantages","text":"Avantage Description \ud83c\udf10 REST Standard, interop\u00e9rable \ud83d\udcd6 Swagger Documentation automatique \ud83d\udee1\ufe0f Validation Donn\u00e9es contr\u00f4l\u00e9es \ud83d\udd27 Maintenable Controllers simples, logique dans services"},{"location":"architecture/api/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'architecture \u2192</li> <li>Introduction API \u2192</li> <li>Endpoints \u2192</li> <li>Controllers \u2192</li> <li>Middlewares \u2192</li> </ul>"},{"location":"architecture/application/","title":"Application","text":""},{"location":"architecture/application/#application-layer-couche-application","title":"Application Layer - Couche Application","text":""},{"location":"architecture/application/#vue-densemble","title":"Vue d'ensemble","text":"<p>La couche Application orchestre la logique m\u00e9tier du Domain pour r\u00e9aliser les cas d'usage de l'application.</p>"},{"location":"architecture/application/#responsabilites","title":"Responsabilit\u00e9s","text":"<ul> <li>\u2705 Orchestrer les cas d'usage (use cases)</li> <li>\u2705 Coordonner les entit\u00e9s du Domain</li> <li>\u2705 Transformer les donn\u00e9es (Entity \u2194 DTO)</li> <li>\u2705 G\u00e9rer les transactions</li> <li>\u2705 Valider les donn\u00e9es d'entr\u00e9e</li> </ul>"},{"location":"architecture/application/#structure","title":"Structure","text":"<pre><code>Application/\n\u251c\u2500\u2500 Services/           # Services applicatifs (ProductService, etc.)\n\u251c\u2500\u2500 DTOs/              # Data Transfer Objects\n\u2502   \u251c\u2500\u2500 Common/        # DTOs partag\u00e9s\n\u2502   \u251c\u2500\u2500 Products/      # DTOs produits\n\u2502   \u251c\u2500\u2500 Orders/        # DTOs commandes\n\u2502   \u251c\u2500\u2500 Users/         # DTOs utilisateurs\n\u2502   \u2514\u2500\u2500 Suppliers/     # DTOs fournisseurs\n\u2514\u2500\u2500 Exceptions/        # Exceptions applicatives\n</code></pre>"},{"location":"architecture/application/#diagramme-des-dependances","title":"Diagramme des d\u00e9pendances","text":"<pre><code>graph LR\n    API[API Controllers] --&gt; APP[Application Services]\n    APP --&gt; DOM[Domain Entities]\n    APP --&gt; REPO[IRepository]\n    INF[Infrastructure] -.-&gt;|Impl\u00e9mente| REPO\n\n    style APP fill:#2196F3,color:#fff</code></pre>"},{"location":"architecture/application/#services-applicatifs","title":"Services applicatifs","text":""},{"location":"architecture/application/#role","title":"R\u00f4le","text":"<p>Les services orchestrent la logique m\u00e9tier :</p> <pre><code>public class ProductService\n{\n    private readonly IProductRepository _repository;\n\n    public async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n    {\n        // 1. Cr\u00e9er l'entit\u00e9 Domain\n        var product = new Product(\n            dto.Name,\n            new Price(dto.Price),\n            new VAT(dto.VatRate)\n        );\n\n        // 2. Persister via le repository\n        await _repository.AddAsync(product);\n\n        // 3. Retourner un DTO\n        return MapToDto(product);\n    }\n}\n</code></pre>"},{"location":"architecture/application/#services-disponibles","title":"Services disponibles","text":"<ul> <li>ProductService : Gestion du catalogue produits</li> <li>SupplierService : Gestion des fournisseurs</li> <li>UserService : Gestion des utilisateurs</li> <li>OrderService : Gestion des commandes</li> </ul> <p>En savoir plus \u2192</p>"},{"location":"architecture/application/#data-transfer-objects-dtos","title":"Data Transfer Objects (DTOs)","text":""},{"location":"architecture/application/#role_1","title":"R\u00f4le","text":"<p>Les DTOs transportent les donn\u00e9es entre les couches :</p> <ul> <li>\u2705 Isolation : Le Domain n'est pas expos\u00e9 \u00e0 l'ext\u00e9rieur</li> <li>\u2705 Simplicit\u00e9 : Structures plates, faciles \u00e0 s\u00e9rialiser</li> <li>\u2705 Versioning : Possibilit\u00e9 d'avoir plusieurs versions d'API</li> </ul> <pre><code>// DTO pour cr\u00e9er un produit\npublic record CreateProductDto(\n    string Name,\n    string Description,\n    decimal Price,\n    decimal VatRate,\n    Guid SupplierId\n);\n\n// DTO pour retourner un produit\npublic record ProductDto(\n    Guid Id,\n    string Name,\n    string Description,\n    decimal Price,\n    decimal VatRate,\n    bool IsActive,\n    Guid SupplierId\n);\n</code></pre> <p>En savoir plus \u2192</p>"},{"location":"architecture/application/#flux-de-donnees","title":"Flux de donn\u00e9es","text":"<pre><code>sequenceDiagram\n    participant C as Controller\n    participant S as Service\n    participant D as Domain\n    participant R as Repository\n\n    C-&gt;&gt;S: CreateAsync(CreateProductDto)\n    S-&gt;&gt;D: new Product(...)\n    D--&gt;&gt;S: Product entity\n    S-&gt;&gt;R: AddAsync(product)\n    R--&gt;&gt;S: void\n    S-&gt;&gt;S: MapToDto(product)\n    S--&gt;&gt;C: ProductDto</code></pre>"},{"location":"architecture/application/#gestion-des-exceptions","title":"Gestion des exceptions","text":"<p>La couche Application capture les exceptions du Domain et les transforme :</p> <pre><code>try\n{\n    var product = await _repository.GetByIdAsync(id);\n    return MapToDto(product);\n}\ncatch (ProductNotFoundException ex)\n{\n    throw new ApplicationServiceException(\"Produit introuvable\", ex);\n}\n</code></pre> <p>En savoir plus \u2192</p>"},{"location":"architecture/application/#validation","title":"Validation","text":""},{"location":"architecture/application/#validation-des-dtos","title":"Validation des DTOs","text":"<p>La validation se fait \u00e0 deux niveaux :</p> <ol> <li>Validation de forme (dans les controllers via ModelState)</li> <li>Validation m\u00e9tier (dans les services)</li> </ol> <pre><code>public async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n{\n    // Validation m\u00e9tier\n    if (dto.Price &lt;= 0)\n        throw new ValidationException(\"Le prix doit \u00eatre strictement positif\");\n\n    // Logique m\u00e9tier\n    // ...\n}\n</code></pre>"},{"location":"architecture/application/#dependances","title":"D\u00e9pendances","text":"<pre><code>graph TB\n    APP[Application Layer]\n    DOM[Domain Layer]\n\n    APP --&gt; DOM\n\n    APP -.-&gt;|Utilise| REPO[IRepository&lt;br/&gt;d\u00e9fini dans Domain]\n\n    style APP fill:#2196F3,color:#fff\n    style DOM fill:#4CAF50,color:#fff</code></pre> <p>R\u00e8gle : Application d\u00e9pend uniquement de Domain.</p>"},{"location":"architecture/application/#avantages","title":"Avantages","text":"Avantage Description \ud83c\udfaf Cas d'usage clairs Chaque service = un ensemble de cas d'usage \ud83d\udd04 Transformation Entity \u2194 DTO proprement g\u00e9r\u00e9 \ud83e\uddea Testabilit\u00e9 Services mockables via interfaces \ud83d\udce6 Isolation Domain prot\u00e9g\u00e9 de l'ext\u00e9rieur"},{"location":"architecture/application/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'architecture \u2192</li> <li>Voir les services \u2192</li> <li>Voir les DTOs \u2192</li> <li>Voir les exceptions \u2192</li> </ul>"},{"location":"architecture/domain/","title":"Domain","text":""},{"location":"architecture/domain/#domain-layer-couche-domaine","title":"Domain Layer - Couche Domaine","text":""},{"location":"architecture/domain/#vue-densemble","title":"Vue d'ensemble","text":"<p>La couche Domain est le c\u0153ur de l'application. Elle contient la logique m\u00e9tier pure, ind\u00e9pendante de toute infrastructure ou framework externe.</p>"},{"location":"architecture/domain/#responsabilites","title":"Responsabilit\u00e9s","text":"<ul> <li>\u2705 D\u00e9finir les entit\u00e9s m\u00e9tier (Product, Order, User, Supplier)</li> <li>\u2705 D\u00e9finir les Value Objects (Price, VAT, Email, etc.)</li> <li>\u2705 D\u00e9finir les interfaces (IRepository, etc.)</li> <li>\u2705 Impl\u00e9menter les r\u00e8gles m\u00e9tier et invariants</li> <li>\u2705 Lever des exceptions m\u00e9tier sp\u00e9cifiques</li> </ul>"},{"location":"architecture/domain/#principe-fondamental","title":"Principe fondamental","text":"<p>La couche Domain ne doit jamais d\u00e9pendre des autres couches.</p> <p>Elle est autonome et r\u00e9utilisable dans n'importe quel contexte.</p>"},{"location":"architecture/domain/#structure","title":"Structure","text":"<pre><code>Domain/\n\u251c\u2500\u2500 Entities/           # Entit\u00e9s m\u00e9tier avec identit\u00e9\n\u251c\u2500\u2500 ValueObjects/       # Objets valeur immuables\n\u251c\u2500\u2500 Interfaces/         # Contrats (IRepository, etc.)\n\u2514\u2500\u2500 Exceptions/         # Exceptions m\u00e9tier\n</code></pre>"},{"location":"architecture/domain/#diagramme-des-dependances","title":"Diagramme des d\u00e9pendances","text":"<pre><code>graph TB\n    subgraph \"Domain Layer - Ind\u00e9pendant\"\n        E[Entities]\n        VO[Value Objects]\n        I[Interfaces]\n        EX[Exceptions]\n    end\n\n    APP[Application Layer] --&gt; E\n    APP --&gt; VO\n    APP --&gt; I\n    INF[Infrastructure Layer] -.-&gt;|Impl\u00e9mente| I\n\n    style E fill:#4CAF50,color:#fff\n    style VO fill:#4CAF50,color:#fff\n    style I fill:#4CAF50,color:#fff\n    style EX fill:#4CAF50,color:#fff</code></pre>"},{"location":"architecture/domain/#contenu-detaille","title":"Contenu d\u00e9taill\u00e9","text":""},{"location":"architecture/domain/#entites","title":"Entit\u00e9s \u2192","text":"<p>Objets avec identit\u00e9 unique (Product, Order, User, Supplier)</p>"},{"location":"architecture/domain/#value-objects","title":"Value Objects \u2192","text":"<p>Objets valeur immuables (Price, VAT, Email)</p>"},{"location":"architecture/domain/#interfaces","title":"Interfaces \u2192","text":"<p>Contrats pour les repositories et services</p>"},{"location":"architecture/domain/#exceptions","title":"Exceptions \u2192","text":"<p>Exceptions m\u00e9tier personnalis\u00e9es</p>"},{"location":"architecture/domain/#regles-metier","title":"R\u00e8gles m\u00e9tier","text":""},{"location":"architecture/domain/#invariants-du-domaine","title":"Invariants du domaine","text":"<p>Les r\u00e8gles m\u00e9tier sont garanties par le Domain :</p> <pre><code>// Le prix doit toujours \u00eatre strictement positif\npublic class Price\n{\n    public decimal Value { get; }\n\n    public Price(decimal value)\n    {\n        if (value &lt;= 0)\n            throw new InvalidPriceException(\"Le prix doit \u00eatre strictement positif\");\n        Value = value;\n    }\n}\n</code></pre>"},{"location":"architecture/domain/#validation-dans-les-entites","title":"Validation dans les entit\u00e9s","text":"<pre><code>// Un produit doit toujours avoir un prix valide\npublic class Product\n{\n    public Price Price { get; private set; }\n\n    public void UpdatePrice(Price newPrice)\n    {\n        Price = newPrice ?? throw new ArgumentNullException(nameof(newPrice));\n        // Le constructeur de Price garantit la validit\u00e9\n    }\n}\n</code></pre>"},{"location":"architecture/domain/#patterns-utilises","title":"Patterns utilis\u00e9s","text":""},{"location":"architecture/domain/#entity-pattern","title":"Entity Pattern","text":"<p>Objets avec identit\u00e9 unique et cycle de vie.</p>"},{"location":"architecture/domain/#value-object-pattern","title":"Value Object Pattern","text":"<p>Objets immuables d\u00e9finis par leurs valeurs.</p>"},{"location":"architecture/domain/#repository-pattern","title":"Repository Pattern","text":"<p>Abstraction de la persistance d\u00e9finie ici, impl\u00e9ment\u00e9e ailleurs.</p>"},{"location":"architecture/domain/#avantages","title":"Avantages","text":"Avantage Description \ud83e\uddea Testabilit\u00e9 Logique m\u00e9tier isol\u00e9e, facile \u00e0 tester \ud83d\udd12 Ind\u00e9pendance Aucune d\u00e9pendance externe \ud83d\udce6 R\u00e9utilisabilit\u00e9 Peut \u00eatre utilis\u00e9 dans diff\u00e9rents contextes \ud83d\udee1\ufe0f Robustesse R\u00e8gles m\u00e9tier garanties"},{"location":"architecture/domain/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'architecture \u2192</li> <li>Voir les entit\u00e9s \u2192</li> <li>Voir les Value Objects \u2192</li> </ul>"},{"location":"architecture/infrastructure/","title":"Infrastructure","text":""},{"location":"architecture/infrastructure/#infrastructure-layer-couche-infrastructure","title":"Infrastructure Layer - Couche Infrastructure","text":""},{"location":"architecture/infrastructure/#vue-densemble","title":"Vue d'ensemble","text":"<p>La couche Infrastructure contient les impl\u00e9mentations concr\u00e8tes des interfaces d\u00e9finies dans le Domain, notamment pour l'acc\u00e8s aux donn\u00e9es.</p>"},{"location":"architecture/infrastructure/#responsabilites","title":"Responsabilit\u00e9s","text":"<ul> <li>\u2705 Impl\u00e9menter les repositories (IRepository)</li> <li>\u2705 G\u00e9rer la persistance des donn\u00e9es (Entity Framework Core)</li> <li>\u2705 Configurer la base de donn\u00e9es</li> <li>\u2705 G\u00e9rer les services externes (API, messagerie, etc.)</li> </ul>"},{"location":"architecture/infrastructure/#structure","title":"Structure","text":"<pre><code>Infrastructure/\n\u251c\u2500\u2500 Repositories/       # Impl\u00e9mentations des repositories\n\u2502   \u251c\u2500\u2500 EfProductRepository.cs\n\u2502   \u251c\u2500\u2500 EfSupplierRepository.cs\n\u2502   \u251c\u2500\u2500 EfUserRepository.cs\n\u2502   \u2514\u2500\u2500 EfOrderRepository.cs\n\u251c\u2500\u2500 Entities/          # Configurations EF Core (optionnel)\n\u2514\u2500\u2500 Exceptions/        # Exceptions infrastructure\n</code></pre>"},{"location":"architecture/infrastructure/#diagramme-des-dependances","title":"Diagramme des d\u00e9pendances","text":"<pre><code>graph TB\n    subgraph \"Infrastructure Layer\"\n        REPO[EfProductRepository]\n        DB[(Base de donn\u00e9es)]\n    end\n\n    subgraph \"Domain Layer\"\n        IREPO[IProductRepository]\n        ENT[Product Entity]\n    end\n\n    REPO -.-&gt;|Impl\u00e9mente| IREPO\n    REPO --&gt; ENT\n    REPO --&gt; DB\n\n    style REPO fill:#9C27B0,color:#fff\n    style IREPO fill:#4CAF50,color:#fff</code></pre>"},{"location":"architecture/infrastructure/#pattern-repository","title":"Pattern Repository","text":""},{"location":"architecture/infrastructure/#definition-domain","title":"D\u00e9finition (Domain)","text":"<pre><code>// D\u00e9fini dans Domain/Interfaces\npublic interface IProductRepository\n{\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync();\n    Task&lt;Product?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(Product product);\n    Task UpdateAsync(Product product);\n    Task DeleteAsync(Guid id);\n}\n</code></pre>"},{"location":"architecture/infrastructure/#implementation-infrastructure","title":"Impl\u00e9mentation (Infrastructure)","text":"<pre><code>// Impl\u00e9ment\u00e9 dans Infrastructure/Repositories\npublic class EfProductRepository : IProductRepository\n{\n    private readonly List&lt;Product&gt; _products = new();\n\n    public async Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync()\n    {\n        return await Task.FromResult(_products.AsEnumerable());\n    }\n\n    public async Task&lt;Product?&gt; GetByIdAsync(Guid id)\n    {\n        return await Task.FromResult(_products.FirstOrDefault(p =&gt; p.Id == id));\n    }\n\n    // ... autres m\u00e9thodes\n}\n</code></pre> <p>En savoir plus \u2192</p>"},{"location":"architecture/infrastructure/#repositories-disponibles","title":"Repositories disponibles","text":"Repository Interface Description EfProductRepository IProductRepository Gestion des produits EfSupplierRepository ISupplierRepository Gestion des fournisseurs EfUserRepository IUserRepository Gestion des utilisateurs EfOrderRepository IOrderRepository Gestion des commandes"},{"location":"architecture/infrastructure/#injection-de-dependances","title":"Injection de d\u00e9pendances","text":"<p>Dans <code>Program.cs</code> :</p> <pre><code>// Enregistrement des repositories\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\nbuilder.Services.AddScoped&lt;ISupplierRepository, EfSupplierRepository&gt;();\nbuilder.Services.AddScoped&lt;IUserRepository, EfUserRepository&gt;();\nbuilder.Services.AddScoped&lt;IOrderRepository, EfOrderRepository&gt;();\n</code></pre>"},{"location":"architecture/infrastructure/#avantages-du-pattern-repository","title":"Avantages du pattern Repository","text":""},{"location":"architecture/infrastructure/#1-abstraction-de-la-persistance","title":"1. Abstraction de la persistance","text":"<pre><code>graph LR\n    APP[Application Service] --&gt; IREPO[IRepository Interface]\n    IREPO -.-&gt;|Impl\u00e9ment\u00e9 par| EF[EfRepository]\n    IREPO -.-&gt;|Pourrait \u00eatre| MONGO[MongoRepository]\n    IREPO -.-&gt;|Pourrait \u00eatre| MEM[InMemoryRepository]</code></pre> <p>Le code m\u00e9tier ne sait pas comment les donn\u00e9es sont stock\u00e9es.</p>"},{"location":"architecture/infrastructure/#2-testabilite","title":"2. Testabilit\u00e9","text":"<pre><code>// Dans les tests, on peut mocker le repository\nvar mockRepo = new Mock&lt;IProductRepository&gt;();\nmockRepo.Setup(r =&gt; r.GetAllAsync()).ReturnsAsync(testProducts);\n\nvar service = new ProductService(mockRepo.Object);\n</code></pre>"},{"location":"architecture/infrastructure/#3-changement-de-persistance-facile","title":"3. Changement de persistance facile","text":"<p>On peut remplacer EF Core par Dapper, MongoDB, etc. sans toucher au Domain ni \u00e0 l'Application.</p>"},{"location":"architecture/infrastructure/#etat-actuel-in-memory","title":"\u00c9tat actuel (In-Memory)","text":"<p>\u26a0\ufe0f Important : Actuellement, les repositories utilisent des collections en m\u00e9moire (<code>List&lt;T&gt;</code>).</p> <pre><code>// Donn\u00e9es perdues au red\u00e9marrage\nprivate readonly List&lt;Product&gt; _products = new();\n</code></pre>"},{"location":"architecture/infrastructure/#migration-vers-une-vraie-base-de-donnees","title":"Migration vers une vraie base de donn\u00e9es","text":"<p>Pour utiliser une vraie base de donn\u00e9es (SQL Server, PostgreSQL, etc.) :</p> <ol> <li>Installer Entity Framework Core</li> <li>Cr\u00e9er un <code>DbContext</code></li> <li>Configurer les entit\u00e9s</li> <li>Modifier les repositories pour utiliser le <code>DbContext</code></li> </ol> <p>En savoir plus \u2192</p>"},{"location":"architecture/infrastructure/#flux-de-donnees","title":"Flux de donn\u00e9es","text":"<pre><code>sequenceDiagram\n    participant S as Service\n    participant R as Repository\n    participant DB as Data Store\n\n    S-&gt;&gt;R: GetAllAsync()\n    R-&gt;&gt;DB: Query data\n    DB--&gt;&gt;R: Data\n    R-&gt;&gt;R: Map to Entities\n    R--&gt;&gt;S: IEnumerable&lt;Product&gt;</code></pre>"},{"location":"architecture/infrastructure/#gestion-des-exceptions","title":"Gestion des exceptions","text":"<p>Les repositories peuvent lever des exceptions :</p> <pre><code>public async Task&lt;Product?&gt; GetByIdAsync(Guid id)\n{\n    var product = _products.FirstOrDefault(p =&gt; p.Id == id);\n\n    if (product == null)\n        throw new ProductNotFoundException(id);\n\n    return await Task.FromResult(product);\n}\n</code></pre>"},{"location":"architecture/infrastructure/#dependances","title":"D\u00e9pendances","text":"<pre><code>graph TB\n    INF[Infrastructure Layer]\n    DOM[Domain Layer]\n\n    INF --&gt; DOM\n    INF -.-&gt;|Impl\u00e9mente| IREPO[IRepository&lt;br/&gt;d\u00e9fini dans Domain]\n\n    style INF fill:#9C27B0,color:#fff\n    style DOM fill:#4CAF50,color:#fff</code></pre> <p>R\u00e8gle : Infrastructure d\u00e9pend de Domain, mais Domain ne d\u00e9pend jamais d'Infrastructure.</p>"},{"location":"architecture/infrastructure/#avantages","title":"Avantages","text":"Avantage Description \ud83d\udd0c Pluggable Facile de changer de technologie de persistance \ud83e\uddea Testable Repositories mockables dans les tests \ud83d\udd12 Isolation Logique m\u00e9tier isol\u00e9e des d\u00e9tails techniques \ud83d\udd04 Maintenable Changements de base de donn\u00e9es localis\u00e9s"},{"location":"architecture/infrastructure/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 l'architecture \u2192</li> <li>Voir les repositories \u2192</li> <li>Configuration (future) \u2192</li> </ul>"},{"location":"architecture/overview/","title":"Vue d'ensemble","text":""},{"location":"architecture/overview/#vue-densemble-de-larchitecture","title":"Vue d'ensemble de l'Architecture","text":""},{"location":"architecture/overview/#principes-architecturaux","title":"Principes architecturaux","text":"<p>AdvancedDevSample est con\u00e7u selon les principes de Clean Architecture pour garantir :</p> <ul> <li>\u2705 S\u00e9paration des responsabilit\u00e9s : Chaque couche a un r\u00f4le d\u00e9fini</li> <li>\u2705 Ind\u00e9pendance du framework : Le domaine ne d\u00e9pend pas de l'infrastructure</li> <li>\u2705 Testabilit\u00e9 : Chaque couche peut \u00eatre test\u00e9e ind\u00e9pendamment</li> <li>\u2705 Maintenabilit\u00e9 : Code organis\u00e9 et \u00e9volutif</li> </ul>"},{"location":"architecture/overview/#architecture-en-couches","title":"Architecture en couches","text":"<pre><code>graph TB\n    subgraph \"Couche Pr\u00e9sentation\"\n        API[Controllers&lt;br/&gt;Middlewares&lt;br/&gt;DTOs Requests/Responses]\n    end\n\n    subgraph \"Couche Application\"\n        Services[Services Applicatifs&lt;br/&gt;DTOs&lt;br/&gt;Orchestration]\n    end\n\n    subgraph \"Couche Domaine\"\n        Entities[Entit\u00e9s M\u00e9tier&lt;br/&gt;Value Objects&lt;br/&gt;Interfaces&lt;br/&gt;R\u00e8gles M\u00e9tier]\n    end\n\n    subgraph \"Couche Infrastructure\"\n        Repos[Repositories&lt;br/&gt;Acc\u00e8s Donn\u00e9es&lt;br/&gt;Impl\u00e9mentations]\n    end\n\n    API --&gt; Services\n    Services --&gt; Entities\n    Repos -.-&gt;|Impl\u00e9mente| Entities\n    API --&gt; Repos</code></pre>"},{"location":"architecture/overview/#flux-de-dependances","title":"Flux de d\u00e9pendances","text":"<pre><code>graph LR\n    API[API] --&gt; APP[Application]\n    APP --&gt; DOM[Domain]\n    INF[Infrastructure] --&gt; DOM\n\n    style DOM fill:#4CAF50,color:#fff\n    style APP fill:#2196F3,color:#fff\n    style API fill:#FF9800,color:#fff\n    style INF fill:#9C27B0,color:#fff</code></pre> <p>R\u00e8gle d'or : Les d\u00e9pendances pointent toujours vers le Domain (centre de l'architecture).</p>"},{"location":"architecture/overview/#description-des-couches","title":"Description des couches","text":""},{"location":"architecture/overview/#1-domain-cur-metier","title":"1. Domain (C\u0153ur m\u00e9tier)","text":"<ul> <li>Responsabilit\u00e9 : Contient la logique m\u00e9tier pure</li> <li>Contenu : Entit\u00e9s, Value Objects, Interfaces, Exceptions m\u00e9tier</li> <li>D\u00e9pendances : Aucune (ind\u00e9pendant)</li> <li>Exemples : <code>Product</code>, <code>Price</code>, <code>VAT</code>, <code>IProductRepository</code></li> </ul> <p>En savoir plus \u2192</p>"},{"location":"architecture/overview/#2-application-services-metier","title":"2. Application (Services m\u00e9tier)","text":"<ul> <li>Responsabilit\u00e9 : Orchestration de la logique m\u00e9tier</li> <li>Contenu : Services applicatifs, DTOs, Exceptions applicatives</li> <li>D\u00e9pendances : Domain uniquement</li> <li>Exemples : <code>ProductService</code>, <code>OrderService</code>, <code>ProductDto</code></li> </ul> <p>En savoir plus \u2192</p>"},{"location":"architecture/overview/#3-infrastructure-acces-donnees","title":"3. Infrastructure (Acc\u00e8s donn\u00e9es)","text":"<ul> <li>Responsabilit\u00e9 : Impl\u00e9mentation concr\u00e8te des interfaces du domaine</li> <li>Contenu : Repositories, Configuration EF Core</li> <li>D\u00e9pendances : Domain</li> <li>Exemples : <code>EfProductRepository</code>, <code>EfOrderRepository</code></li> </ul> <p>En savoir plus \u2192</p>"},{"location":"architecture/overview/#4-api-presentation","title":"4. API (Pr\u00e9sentation)","text":"<ul> <li>Responsabilit\u00e9 : Exposition des fonctionnalit\u00e9s via HTTP</li> <li>Contenu : Controllers, Middlewares, Configuration</li> <li>D\u00e9pendances : Application, Infrastructure (injection)</li> <li>Exemples : <code>ProductController</code>, <code>ExceptionHandlingMiddleware</code></li> </ul> <p>En savoir plus \u2192</p>"},{"location":"architecture/overview/#patterns-utilises","title":"Patterns utilis\u00e9s","text":""},{"location":"architecture/overview/#repository-pattern","title":"Repository Pattern","text":"<p>Abstraction de l'acc\u00e8s aux donn\u00e9es :</p> <pre><code>classDiagram\n    class IProductRepository {\n        &lt;&lt;interface&gt;&gt;\n        +GetAllAsync() Task~IEnumerable~Product~~\n        +GetByIdAsync(id) Task~Product~\n        +AddAsync(product) Task\n    }\n\n    class EfProductRepository {\n        +GetAllAsync() Task~IEnumerable~Product~~\n        +GetByIdAsync(id) Task~Product~\n        +AddAsync(product) Task\n    }\n\n    IProductRepository &lt;|.. EfProductRepository</code></pre>"},{"location":"architecture/overview/#dependency-injection","title":"Dependency Injection","text":"<p>Inversion de contr\u00f4le pour le d\u00e9couplage :</p> <pre><code>// Configuration dans Program.cs\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\nbuilder.Services.AddScoped&lt;ProductService&gt;();\n</code></pre>"},{"location":"architecture/overview/#dto-pattern","title":"DTO Pattern","text":"<p>Transfert de donn\u00e9es entre couches :</p> <pre><code>graph LR\n    Client[Client HTTP] --&gt;|ProductDto| API[ProductController]\n    API --&gt;|ProductDto| Service[ProductService]\n    Service --&gt;|Product| Domain[Domain Entity]</code></pre>"},{"location":"architecture/overview/#avantages-de-cette-architecture","title":"Avantages de cette architecture","text":"Avantage Description \ud83e\uddea Testabilit\u00e9 Chaque couche peut \u00eatre test\u00e9e en isolation \ud83d\udd27 Maintenabilit\u00e9 Code organis\u00e9, facile \u00e0 modifier \ud83d\udce6 Modularit\u00e9 Couplage faible entre les couches \ud83d\udd04 \u00c9volutivit\u00e9 Facile d'ajouter de nouvelles fonctionnalit\u00e9s \ud83d\udee1\ufe0f Robustesse Validation m\u00e9tier centralis\u00e9e"},{"location":"architecture/overview/#regles-de-codage","title":"R\u00e8gles de codage","text":"<ol> <li>Le Domain ne doit jamais d\u00e9pendre des autres couches</li> <li>Les DTOs ne doivent pas \u00eatre utilis\u00e9s dans le Domain</li> <li>Les entit\u00e9s du Domain ne doivent pas \u00eatre expos\u00e9es directement par l'API</li> <li>L'Infrastructure impl\u00e9mente les interfaces d\u00e9finies dans le Domain</li> <li>Les services Application orchestrent la logique m\u00e9tier</li> </ol>"},{"location":"architecture/overview/#navigation","title":"Navigation","text":"<ul> <li>Domain Layer \u2192</li> <li>Application Layer \u2192</li> <li>Infrastructure Layer \u2192</li> <li>API Layer \u2192</li> </ul>"},{"location":"development/best-practices/","title":"Bonnes Pratiques","text":""},{"location":"development/best-practices/#bonnes-pratiques-de-developpement","title":"Bonnes Pratiques de D\u00e9veloppement","text":""},{"location":"development/best-practices/#conventions-de-code","title":"Conventions de code","text":""},{"location":"development/best-practices/#nommage","title":"Nommage","text":"<ul> <li>Classes : PascalCase (<code>ProductService</code>, <code>OrderController</code>)</li> <li>M\u00e9thodes : PascalCase (<code>GetAllAsync</code>, <code>CreateProduct</code>)</li> <li>Variables/Param\u00e8tres : camelCase (<code>productId</code>, <code>orderDate</code>)</li> <li>Champs priv\u00e9s : _camelCase (<code>_productRepository</code>, <code>_logger</code>)</li> <li>Constantes : UPPER_CASE (<code>MAX_RETRY_COUNT</code>)</li> </ul>"},{"location":"development/best-practices/#organisation-des-fichiers","title":"Organisation des fichiers","text":"<pre><code>Projet/\n\u251c\u2500\u2500 Entities/           # Entit\u00e9s m\u00e9tier\n\u251c\u2500\u2500 ValueObjects/       # Value Objects\n\u251c\u2500\u2500 Interfaces/         # Interfaces (IRepository, etc.)\n\u251c\u2500\u2500 Services/           # Services applicatifs\n\u251c\u2500\u2500 DTOs/              # Data Transfer Objects\n\u2514\u2500\u2500 Exceptions/        # Exceptions personnalis\u00e9es\n</code></pre>"},{"location":"development/best-practices/#regles-de-developpement","title":"R\u00e8gles de d\u00e9veloppement","text":""},{"location":"development/best-practices/#1-respect-de-larchitecture-clean-code","title":"1. Respect de l'architecture Clean Code","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>// Dans Domain - INTERDIT\nusing Microsoft.EntityFrameworkCore;\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>// Domain d\u00e9pend uniquement de lui-m\u00eame\nnamespace AdvancedDevSample.Domain.Entities;\n</code></pre><p></p>"},{"location":"development/best-practices/#2-utilisation-des-dtos","title":"2. Utilisation des DTOs","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>[HttpPost]\npublic async Task&lt;Product&gt; Create(Product product) // Exposer l'entit\u00e9\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>[HttpPost]\npublic async Task&lt;ProductDto&gt; Create(CreateProductDto dto) // Utiliser des DTOs\n</code></pre><p></p>"},{"location":"development/best-practices/#3-gestion-des-erreurs","title":"3. Gestion des erreurs","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>throw new Exception(\"Erreur\");\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>throw new ProductNotFoundException(productId);\n</code></pre><p></p>"},{"location":"development/best-practices/#4-validation-metier","title":"4. Validation m\u00e9tier","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>// Validation dans le controller\nif (price &lt;= 0)\n    return BadRequest();\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>// Validation dans l'entit\u00e9/Value Object\npublic Price(decimal value)\n{\n    if (value &lt;= 0)\n        throw new InvalidPriceException(\"Le prix doit \u00eatre strictement positif\");\n    Value = value;\n}\n</code></pre><p></p>"},{"location":"development/best-practices/#tests","title":"Tests","text":""},{"location":"development/best-practices/#structure-des-tests","title":"Structure des tests","text":"<pre><code>// Arrange - Act - Assert pattern\n[Fact]\npublic async Task GetAllAsync_ShouldReturnAllProducts()\n{\n    // Arrange\n    var products = CreateTestProducts();\n    _mockRepository.Setup(r =&gt; r.GetAllAsync()).ReturnsAsync(products);\n\n    // Act\n    var result = await _service.GetAllAsync();\n\n    // Assert\n    Assert.Equal(products.Count, result.Count());\n}\n</code></pre>"},{"location":"development/best-practices/#nommage-des-tests","title":"Nommage des tests","text":"<p>Pattern : <code>MethodName_Scenario_ExpectedResult</code></p> <p>Exemples : - <code>CreateProduct_WithValidData_ShouldReturnProductDto</code> - <code>CreateProduct_WithNegativePrice_ShouldThrowException</code> - <code>GetProduct_WithInvalidId_ShouldReturnNull</code></p>"},{"location":"development/best-practices/#commentaires-xml","title":"Commentaires XML","text":""},{"location":"development/best-practices/#pour-les-classes","title":"Pour les classes","text":"<pre><code>/// &lt;summary&gt;\n/// Service de gestion des produits.\n/// Fournit les op\u00e9rations CRUD pour les entit\u00e9s Product.\n/// &lt;/summary&gt;\npublic class ProductService\n{\n}\n</code></pre>"},{"location":"development/best-practices/#pour-les-methodes","title":"Pour les m\u00e9thodes","text":"<pre><code>/// &lt;summary&gt;\n/// R\u00e9cup\u00e8re tous les produits actifs du catalogue.\n/// &lt;/summary&gt;\n/// &lt;returns&gt;Liste de tous les produits sous forme de DTOs&lt;/returns&gt;\n/// &lt;exception cref=\"ApplicationServiceException\"&gt;En cas d'erreur lors de la r\u00e9cup\u00e9ration&lt;/exception&gt;\npublic async Task&lt;IEnumerable&lt;ProductDto&gt;&gt; GetAllAsync()\n{\n}\n</code></pre>"},{"location":"development/best-practices/#pour-les-parametres","title":"Pour les param\u00e8tres","text":"<pre><code>/// &lt;summary&gt;\n/// Cr\u00e9e un nouveau produit dans le catalogue.\n/// &lt;/summary&gt;\n/// &lt;param name=\"dto\"&gt;Donn\u00e9es du produit \u00e0 cr\u00e9er&lt;/param&gt;\n/// &lt;returns&gt;Le produit cr\u00e9\u00e9 avec son identifiant g\u00e9n\u00e9r\u00e9&lt;/returns&gt;\npublic async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n{\n}\n</code></pre>"},{"location":"development/best-practices/#astuces-de-performance","title":"Astuces de performance","text":""},{"location":"development/best-practices/#1-utiliser-asyncawait","title":"1. Utiliser Async/Await","text":"<pre><code>// Toujours pour les op\u00e9rations I/O\npublic async Task&lt;Product&gt; GetByIdAsync(Guid id)\n{\n    return await _repository.GetByIdAsync(id);\n}\n</code></pre>"},{"location":"development/best-practices/#2-eviter-les-requetes-n1","title":"2. \u00c9viter les requ\u00eates N+1","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>foreach (var order in orders)\n{\n    order.User = await _userRepository.GetByIdAsync(order.UserId);\n}\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>var orders = await _repository.GetAllWithUsersAsync();\n</code></pre><p></p>"},{"location":"development/best-practices/#3-utiliser-ienumerable-pour-les-lectures-seules","title":"3. Utiliser IEnumerable pour les lectures seules","text":"<pre><code>public async Task&lt;IEnumerable&lt;ProductDto&gt;&gt; GetAllAsync() // Pas List&lt;&gt;\n</code></pre>"},{"location":"development/best-practices/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"development/best-practices/#1-validation-des-entrees","title":"1. Validation des entr\u00e9es","text":"<pre><code>// Toujours valider c\u00f4t\u00e9 serveur\nif (string.IsNullOrWhiteSpace(dto.Name))\n    throw new ValidationException(\"Le nom est requis\");\n</code></pre>"},{"location":"development/best-practices/#2-ne-pas-exposer-les-details-techniques","title":"2. Ne pas exposer les d\u00e9tails techniques","text":"<p>\u274c \u00c0 \u00e9viter : </p><pre><code>catch (Exception ex)\n{\n    return StatusCode(500, ex.StackTrace); // Fuite d'informations\n}\n</code></pre><p></p> <p>\u2705 \u00c0 faire : </p><pre><code>catch (Exception ex)\n{\n    _logger.LogError(ex, \"Erreur lors de la cr\u00e9ation\");\n    return StatusCode(500, \"Une erreur est survenue\");\n}\n</code></pre><p></p>"},{"location":"development/best-practices/#git-commits","title":"Git - Commits","text":""},{"location":"development/best-practices/#format-des-messages","title":"Format des messages","text":"<pre><code>type(scope): description courte\n\nDescription d\u00e9taill\u00e9e si n\u00e9cessaire\n\nFixes #issue_number\n</code></pre>"},{"location":"development/best-practices/#types","title":"Types","text":"<ul> <li><code>feat</code>: Nouvelle fonctionnalit\u00e9</li> <li><code>fix</code>: Correction de bug</li> <li><code>docs</code>: Documentation</li> <li><code>refactor</code>: Refactoring</li> <li><code>test</code>: Ajout/modification de tests</li> <li><code>chore</code>: T\u00e2ches diverses</li> </ul>"},{"location":"development/best-practices/#exemples","title":"Exemples","text":"<pre><code>feat(products): ajout de la validation du prix\n\nImpl\u00e9mentation de la r\u00e8gle m\u00e9tier : le prix doit \u00eatre strictement positif.\nAjout de tests unitaires correspondants.\n\nCloses #42\n</code></pre>"},{"location":"development/best-practices/#checklist-avant-commit","title":"Checklist avant commit","text":"<ul> <li>[ ] Le code compile sans erreur</li> <li>[ ] Tous les tests passent</li> <li>[ ] Les commentaires XML sont \u00e0 jour</li> <li>[ ] Respect des conventions de nommage</li> <li>[ ] Pas de code comment\u00e9</li> <li>[ ] Pas de <code>TODO</code> laiss\u00e9s</li> <li>[ ] Architecture respect\u00e9e (pas de d\u00e9pendances invers\u00e9es)</li> </ul> <p>Pour plus d'informations, consulter la documentation architecture</p>"},{"location":"development/configuration/","title":"Configuration","text":""},{"location":"development/configuration/#configuration-de-lapplication","title":"Configuration de l'Application","text":""},{"location":"development/configuration/#fichiers-de-configuration","title":"Fichiers de configuration","text":""},{"location":"development/configuration/#appsettingsjson","title":"appsettings.json","text":"<p>Configuration par d\u00e9faut de l'application.</p> <pre><code>{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft.AspNetCore\": \"Warning\"\n    }\n  },\n  \"AllowedHosts\": \"*\"\n}\n</code></pre>"},{"location":"development/configuration/#appsettingsdevelopmentjson","title":"appsettings.Development.json","text":"<p>Configuration sp\u00e9cifique au d\u00e9veloppement.</p> <pre><code>{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Debug\",\n      \"Microsoft.AspNetCore\": \"Information\"\n    }\n  }\n}\n</code></pre>"},{"location":"development/configuration/#variables-denvironnement","title":"Variables d'environnement","text":""},{"location":"development/configuration/#aspnetcore_environment","title":"ASPNETCORE_ENVIRONMENT","text":"<p>D\u00e9finit l'environnement d'ex\u00e9cution :</p> <ul> <li><code>Development</code> : D\u00e9veloppement local</li> <li><code>Staging</code> : Pr\u00e9-production</li> <li><code>Production</code> : Production</li> </ul> <pre><code># Windows (PowerShell)\n$env:ASPNETCORE_ENVIRONMENT=\"Development\"\n\n# Linux/Mac\nexport ASPNETCORE_ENVIRONMENT=Development\n</code></pre>"},{"location":"development/configuration/#configuration-des-ports","title":"Configuration des ports","text":""},{"location":"development/configuration/#launchsettingsjson","title":"launchSettings.json","text":"<pre><code>{\n  \"profiles\": {\n    \"https\": {\n      \"commandName\": \"Project\",\n      \"dotnetRunMessages\": true,\n      \"launchBrowser\": true,\n      \"launchUrl\": \"swagger\",\n      \"applicationUrl\": \"https://localhost:5181;http://localhost:5180\",\n      \"environmentVariables\": {\n        \"ASPNETCORE_ENVIRONMENT\": \"Development\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"development/configuration/#configuration-swagger","title":"Configuration Swagger","text":"<p>Swagger est activ\u00e9 uniquement en d\u00e9veloppement :</p> <pre><code>if (app.Environment.IsDevelopment())\n{\n    app.UseSwagger();\n    app.UseSwaggerUI();\n}\n</code></pre>"},{"location":"development/configuration/#logging","title":"Logging","text":""},{"location":"development/configuration/#configuration-des-niveaux","title":"Configuration des niveaux","text":"<pre><code>{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft\": \"Warning\",\n      \"Microsoft.Hosting.Lifetime\": \"Information\",\n      \"AdvancedDevSample\": \"Debug\"\n    }\n  }\n}\n</code></pre>"},{"location":"development/configuration/#utilisation-dans-le-code","title":"Utilisation dans le code","text":"<pre><code>public class ProductService\n{\n    private readonly ILogger&lt;ProductService&gt; _logger;\n\n    public ProductService(ILogger&lt;ProductService&gt; logger)\n    {\n        _logger = logger;\n    }\n\n    public async Task&lt;ProductDto&gt; CreateAsync(CreateProductDto dto)\n    {\n        _logger.LogInformation(\"Cr\u00e9ation du produit {Name}\", dto.Name);\n        // ...\n    }\n}\n</code></pre>"},{"location":"development/configuration/#configuration-future","title":"Configuration future","text":""},{"location":"development/configuration/#connexion-base-de-donnees","title":"Connexion base de donn\u00e9es","text":"<pre><code>{\n  \"ConnectionStrings\": {\n    \"DefaultConnection\": \"Server=localhost;Database=AdvancedDevSampleDb;Trusted_Connection=True;\"\n  }\n}\n</code></pre>"},{"location":"development/configuration/#cors","title":"CORS","text":"<pre><code>builder.Services.AddCors(options =&gt;\n{\n    options.AddPolicy(\"AllowAll\", policy =&gt;\n    {\n        policy.AllowAnyOrigin()\n              .AllowAnyMethod()\n              .AllowAnyHeader();\n    });\n});\n\napp.UseCors(\"AllowAll\");\n</code></pre>"},{"location":"development/configuration/#navigation","title":"Navigation","text":"<ul> <li>Retour au d\u00e9veloppement \u2192</li> <li>Bonnes pratiques \u2192</li> </ul>"},{"location":"development/installation/","title":"Installation","text":""},{"location":"development/installation/#installation-et-configuration","title":"Installation et Configuration","text":""},{"location":"development/installation/#prerequis","title":"Pr\u00e9requis","text":""},{"location":"development/installation/#logiciels-requis","title":"Logiciels requis","text":"Logiciel Version minimale Lien .NET SDK 9.0 T\u00e9l\u00e9charger IDE - Rider, Visual Studio 2022, ou VS Code Git 2.0+ T\u00e9l\u00e9charger"},{"location":"development/installation/#optionnel","title":"Optionnel","text":"<ul> <li>Docker : Pour containerisation future</li> <li>Postman : Alternative \u00e0 Swagger pour tester l'API</li> </ul>"},{"location":"development/installation/#installation","title":"Installation","text":""},{"location":"development/installation/#1-cloner-le-repository","title":"1. Cloner le repository","text":"<pre><code>git clone https://github.com/yourusername/AdvancedDevSample.git\ncd AdvancedDevSample\n</code></pre>"},{"location":"development/installation/#2-restaurer-les-dependances","title":"2. Restaurer les d\u00e9pendances","text":"<pre><code>dotnet restore\n</code></pre>"},{"location":"development/installation/#3-compiler-la-solution","title":"3. Compiler la solution","text":"<pre><code>dotnet build\n</code></pre>"},{"location":"development/installation/#4-executer-les-tests","title":"4. Ex\u00e9cuter les tests","text":"<pre><code>dotnet test\n</code></pre>"},{"location":"development/installation/#configuration-de-lenvironnement","title":"Configuration de l'environnement","text":""},{"location":"development/installation/#variables-denvironnement","title":"Variables d'environnement","text":"<p>Cr\u00e9er un fichier <code>appsettings.Development.json</code> dans <code>AdvancedDevSample.API</code> :</p> <pre><code>{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft.AspNetCore\": \"Warning\"\n    }\n  },\n  \"AllowedHosts\": \"*\"\n}\n</code></pre>"},{"location":"development/installation/#configuration-de-lide","title":"Configuration de l'IDE","text":""},{"location":"development/installation/#jetbrains-rider","title":"JetBrains Rider","text":"<ol> <li>Ouvrir <code>AdvancedDevSample.sln</code></li> <li>D\u00e9finir <code>AdvancedDevSample.API</code> comme projet de d\u00e9marrage</li> <li>Configurer le profil de d\u00e9marrage : <code>https</code> ou <code>http</code></li> </ol>"},{"location":"development/installation/#visual-studio","title":"Visual Studio","text":"<ol> <li>Ouvrir <code>AdvancedDevSample.sln</code></li> <li>Clic droit sur <code>AdvancedDevSample.API</code> \u2192 \"D\u00e9finir comme projet de d\u00e9marrage\"</li> <li>Appuyer sur F5 pour lancer en mode debug</li> </ol>"},{"location":"development/installation/#vs-code","title":"VS Code","text":"<ol> <li>Installer l'extension C# Dev Kit</li> <li>Ouvrir le dossier du projet</li> <li>Cr\u00e9er <code>.vscode/launch.json</code> :</li> </ol> <pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \".NET Core Launch (web)\",\n      \"type\": \"coreclr\",\n      \"request\": \"launch\",\n      \"preLaunchTask\": \"build\",\n      \"program\": \"${workspaceFolder}/AdvancedDevSample.API/bin/Debug/net9.0/AdvancedDevSample.API.dll\",\n      \"args\": [],\n      \"cwd\": \"${workspaceFolder}/AdvancedDevSample.API\",\n      \"stopAtEntry\": false,\n      \"serverReadyAction\": {\n        \"action\": \"openExternally\",\n        \"pattern\": \"\\\\bNow listening on:\\\\s+(https?://\\\\S+)\"\n      },\n      \"env\": {\n        \"ASPNETCORE_ENVIRONMENT\": \"Development\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"development/installation/#lancer-lapplication","title":"Lancer l'application","text":""},{"location":"development/installation/#en-ligne-de-commande","title":"En ligne de commande","text":"<pre><code>cd AdvancedDevSample.API\ndotnet run\n</code></pre>"},{"location":"development/installation/#acces-a-lapplication","title":"Acc\u00e8s \u00e0 l'application","text":"<p>Une fois lanc\u00e9e, l'application est accessible via :</p> <ul> <li>HTTPS : <code>https://localhost:5181</code></li> <li>HTTP : <code>http://localhost:5180</code></li> <li>Swagger UI : <code>https://localhost:5181/swagger</code></li> </ul>"},{"location":"development/installation/#configuration-des-commentaires-xml-swagger","title":"Configuration des commentaires XML (Swagger)","text":"<p>Les commentaires XML sont automatiquement g\u00e9n\u00e9r\u00e9s. V\u00e9rifier dans chaque <code>.csproj</code> :</p> <pre><code>&lt;PropertyGroup&gt;\n  &lt;GenerateDocumentationFile&gt;true&lt;/GenerateDocumentationFile&gt;\n  &lt;NoWarn&gt;$(NoWarn);1591&lt;/NoWarn&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>"},{"location":"development/installation/#commandes-utiles","title":"Commandes utiles","text":""},{"location":"development/installation/#build","title":"Build","text":"<pre><code># Build en mode Debug\ndotnet build\n\n# Build en mode Release\ndotnet build -c Release\n\n# Build avec verbosit\u00e9\ndotnet build -v detailed\n</code></pre>"},{"location":"development/installation/#tests","title":"Tests","text":"<pre><code># Lancer tous les tests\ndotnet test\n\n# Lancer les tests avec couverture\ndotnet test --collect:\"XPlat Code Coverage\"\n\n# Lancer un projet de test sp\u00e9cifique\ndotnet test AdvancedDevSample.Test/AdvancedDevSample.Test.csproj\n</code></pre>"},{"location":"development/installation/#nettoyage","title":"Nettoyage","text":"<pre><code># Nettoyer les artifacts de build\ndotnet clean\n\n# Nettoyer et rebuild\ndotnet clean &amp;&amp; dotnet build\n</code></pre>"},{"location":"development/installation/#resolution-de-problemes","title":"R\u00e9solution de probl\u00e8mes","text":""},{"location":"development/installation/#port-deja-utilise","title":"Port d\u00e9j\u00e0 utilis\u00e9","text":"<p>Si le port 5181 est d\u00e9j\u00e0 utilis\u00e9 :</p> <ol> <li>Modifier <code>Properties/launchSettings.json</code> dans <code>AdvancedDevSample.API</code></li> <li>Changer les ports dans <code>applicationUrl</code></li> </ol> <pre><code>\"applicationUrl\": \"https://localhost:7001;http://localhost:5001\"\n</code></pre>"},{"location":"development/installation/#erreurs-de-restauration-nuget","title":"Erreurs de restauration NuGet","text":"<pre><code># Nettoyer le cache NuGet\ndotnet nuget locals all --clear\n\n# Restaurer \u00e0 nouveau\ndotnet restore\n</code></pre>"},{"location":"development/installation/#erreurs-de-compilation","title":"Erreurs de compilation","text":"<pre><code># V\u00e9rifier la version du SDK\ndotnet --version\n\n# Lister les SDKs install\u00e9s\ndotnet --list-sdks\n</code></pre>"},{"location":"development/installation/#documentation-de-lapi","title":"Documentation de l'API","text":""},{"location":"development/installation/#generer-la-documentation-swagger-statique","title":"G\u00e9n\u00e9rer la documentation Swagger statique","text":"<pre><code># Installer Swashbuckle CLI\ndotnet tool install -g Swashbuckle.AspNetCore.Cli\n\n# G\u00e9n\u00e9rer le fichier swagger.json\nswagger tofile --output swagger.json AdvancedDevSample.API/bin/Debug/net9.0/AdvancedDevSample.API.dll v1\n</code></pre>"},{"location":"development/installation/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<ul> <li>\u2705 Configuration avanc\u00e9e</li> <li>\u2705 Bonnes pratiques de d\u00e9veloppement</li> <li>\u2705 Guide de contribution</li> </ul> <p>Guide mis \u00e0 jour pour .NET 9.0 - F\u00e9vrier 2026</p>"},{"location":"domain/entities/","title":"Entit\u00e9s","text":""},{"location":"domain/entities/#domain-entites","title":"Domain - Entit\u00e9s","text":""},{"location":"domain/entities/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les entit\u00e9s sont des objets m\u00e9tier avec une identit\u00e9 unique qui persiste dans le temps.</p>"},{"location":"domain/entities/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>\u2705 Identit\u00e9 unique : Guid comme identifiant</li> <li>\u2705 Logique m\u00e9tier : Comportements et r\u00e8gles</li> <li>\u2705 Invariants : \u00c9tats toujours valides</li> <li>\u2705 Cycle de vie : Peuvent \u00eatre modifi\u00e9es</li> </ul>"},{"location":"domain/entities/#entites-disponibles","title":"Entit\u00e9s disponibles","text":""},{"location":"domain/entities/#product","title":"Product","text":"<p>Repr\u00e9sente un produit du catalogue.</p> <pre><code>public class Product\n{\n    public Guid Id { get; private set; }\n    public string Name { get; private set; }\n    public string Description { get; private set; }\n    public Price Price { get; private set; }\n    public VAT Vat { get; private set; }\n    public bool IsActive { get; private set; }\n    public Guid SupplierId { get; private set; }\n\n    public Product(string name, string description, Price price, VAT vat, Guid supplierId)\n    {\n        Id = Guid.NewGuid();\n        Name = name ?? throw new ArgumentNullException(nameof(name));\n        Description = description ?? string.Empty;\n        Price = price ?? throw new ArgumentNullException(nameof(price));\n        Vat = vat ?? throw new ArgumentNullException(nameof(vat));\n        SupplierId = supplierId;\n        IsActive = true;\n    }\n\n    // M\u00e9thodes m\u00e9tier\n    public void UpdatePrice(Price newPrice)\n    {\n        Price = newPrice ?? throw new ArgumentNullException(nameof(newPrice));\n    }\n\n    public void Activate() =&gt; IsActive = true;\n    public void Deactivate() =&gt; IsActive = false;\n}\n</code></pre> <p>Invariants : - Le prix doit toujours \u00eatre valide (&gt;0) - Le nom ne peut pas \u00eatre null - La TVA doit \u00eatre valide (0-100%)</p>"},{"location":"domain/entities/#supplier","title":"Supplier","text":"<p>Repr\u00e9sente un fournisseur.</p> <pre><code>public class Supplier\n{\n    public Guid Id { get; private set; }\n    public string Name { get; private set; }\n    public string Email { get; private set; }\n    public string Phone { get; private set; }\n\n    public Supplier(string name, string email, string phone)\n    {\n        Id = Guid.NewGuid();\n        Name = name ?? throw new ArgumentNullException(nameof(name));\n        Email = email ?? throw new ArgumentNullException(nameof(email));\n        Phone = phone ?? string.Empty;\n    }\n}\n</code></pre>"},{"location":"domain/entities/#user","title":"User","text":"<p>Repr\u00e9sente un utilisateur.</p> <pre><code>public class User\n{\n    public Guid Id { get; private set; }\n    public string FirstName { get; private set; }\n    public string LastName { get; private set; }\n    public string Email { get; private set; }\n\n    public User(string firstName, string lastName, string email)\n    {\n        Id = Guid.NewGuid();\n        FirstName = firstName ?? throw new ArgumentNullException(nameof(firstName));\n        LastName = lastName ?? throw new ArgumentNullException(nameof(lastName));\n        Email = email ?? throw new ArgumentNullException(nameof(email));\n    }\n}\n</code></pre>"},{"location":"domain/entities/#order","title":"Order","text":"<p>Repr\u00e9sente une commande avec ses lignes.</p> <pre><code>public class Order\n{\n    public Guid Id { get; private set; }\n    public Guid UserId { get; private set; }\n    public DateTime OrderDate { get; private set; }\n    public List&lt;OrderLine&gt; OrderLines { get; private set; }\n\n    public Order(Guid userId, DateTime orderDate)\n    {\n        Id = Guid.NewGuid();\n        UserId = userId;\n        OrderDate = orderDate;\n        OrderLines = new List&lt;OrderLine&gt;();\n    }\n\n    public void AddLine(OrderLine line)\n    {\n        OrderLines.Add(line ?? throw new ArgumentNullException(nameof(line)));\n    }\n\n    public decimal GetTotalAmount()\n    {\n        return OrderLines.Sum(line =&gt; line.Quantity * line.UnitPrice);\n    }\n}\n</code></pre>"},{"location":"domain/entities/#orderline","title":"OrderLine","text":"<p>Repr\u00e9sente une ligne de commande.</p> <pre><code>public class OrderLine\n{\n    public Guid Id { get; private set; }\n    public Guid ProductId { get; private set; }\n    public int Quantity { get; private set; }\n    public decimal UnitPrice { get; private set; }\n\n    public OrderLine(Guid productId, int quantity, decimal unitPrice)\n    {\n        if (quantity &lt;= 0)\n            throw new ArgumentException(\"La quantit\u00e9 doit \u00eatre strictement positive\");\n        if (unitPrice &lt;= 0)\n            throw new ArgumentException(\"Le prix unitaire doit \u00eatre strictement positif\");\n\n        Id = Guid.NewGuid();\n        ProductId = productId;\n        Quantity = quantity;\n        UnitPrice = unitPrice;\n    }\n}\n</code></pre>"},{"location":"domain/entities/#principes-de-conception","title":"Principes de conception","text":""},{"location":"domain/entities/#encapsulation","title":"Encapsulation","text":"<p>Les setters sont priv\u00e9s pour prot\u00e9ger l'int\u00e9grit\u00e9 :</p> <pre><code>public Price Price { get; private set; }\n\n// Modification via m\u00e9thode m\u00e9tier\npublic void UpdatePrice(Price newPrice)\n{\n    // Validation + logique m\u00e9tier\n    Price = newPrice ?? throw new ArgumentNullException(nameof(newPrice));\n}\n</code></pre>"},{"location":"domain/entities/#validation-dans-le-constructeur","title":"Validation dans le constructeur","text":"<pre><code>public Product(string name, Price price)\n{\n    // Validation imm\u00e9diate\n    Name = name ?? throw new ArgumentNullException(nameof(name));\n    Price = price ?? throw new ArgumentNullException(nameof(price));\n\n    // \u00c9tat valide garanti\n}\n</code></pre>"},{"location":"domain/entities/#methodes-metier","title":"M\u00e9thodes m\u00e9tier","text":"<p>Les entit\u00e9s contiennent leur propre logique :</p> <pre><code>public void Activate() =&gt; IsActive = true;\npublic void Deactivate() =&gt; IsActive = false;\n\npublic decimal GetTotalAmount()\n{\n    return OrderLines.Sum(line =&gt; line.Quantity * line.UnitPrice);\n}\n</code></pre>"},{"location":"domain/entities/#entity-vs-value-object","title":"Entity vs Value Object","text":"Entity Value Object Identit\u00e9 unique (Id) D\u00e9fini par ses valeurs Mutable Immuable Cycle de vie Pas de cycle de vie <code>Product</code>, <code>Order</code> <code>Price</code>, <code>VAT</code>"},{"location":"domain/entities/#navigation","title":"Navigation","text":"<ul> <li>Retour au Domain \u2192</li> <li>Value Objects \u2192</li> <li>Interfaces \u2192</li> </ul>"},{"location":"domain/exceptions/","title":"Exceptions","text":""},{"location":"domain/exceptions/#domain-exceptions","title":"Domain - Exceptions","text":""},{"location":"domain/exceptions/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les exceptions m\u00e9tier sont lev\u00e9es lorsque les r\u00e8gles du domain sont viol\u00e9es.</p>"},{"location":"domain/exceptions/#exceptions-disponibles","title":"Exceptions disponibles","text":""},{"location":"domain/exceptions/#invalidpriceexception","title":"InvalidPriceException","text":"<p>Lev\u00e9e lorsqu'un prix invalide est fourni.</p> <pre><code>public class InvalidPriceException : DomainException\n{\n    public InvalidPriceException(string message) \n        : base(message)\n    {\n    }\n\n    public InvalidPriceException(decimal price) \n        : base($\"Le prix {price} est invalide. Le prix doit \u00eatre strictement positif.\")\n    {\n    }\n}\n</code></pre> <p>Utilisation :</p> <pre><code>public class Price\n{\n    public decimal Value { get; }\n\n    public Price(decimal value)\n    {\n        if (value &lt;= 0)\n            throw new InvalidPriceException(value);\n\n        Value = value;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#invalidvatexception","title":"InvalidVatException","text":"<p>Lev\u00e9e lorsqu'un taux de TVA invalide est fourni.</p> <pre><code>public class InvalidVatException : DomainException\n{\n    public InvalidVatException(string message) \n        : base(message)\n    {\n    }\n\n    public InvalidVatException(decimal rate) \n        : base($\"Le taux de TVA {rate}% est invalide. Il doit \u00eatre entre 0 et 100.\")\n    {\n    }\n}\n</code></pre> <p>Utilisation :</p> <pre><code>public class VAT\n{\n    public decimal Rate { get; }\n\n    public VAT(decimal rate)\n    {\n        if (rate &lt; 0 || rate &gt; 100)\n            throw new InvalidVatException(rate);\n\n        Rate = rate;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#productnotfoundexception","title":"ProductNotFoundException","text":"<p>Lev\u00e9e lorsqu'un produit n'est pas trouv\u00e9.</p> <pre><code>public class ProductNotFoundException : DomainException\n{\n    public Guid ProductId { get; }\n\n    public ProductNotFoundException(Guid productId) \n        : base($\"Produit avec l'ID '{productId}' introuvable.\")\n    {\n        ProductId = productId;\n    }\n}\n</code></pre> <p>Utilisation :</p> <pre><code>public async Task&lt;Product&gt; GetByIdAsync(Guid id)\n{\n    var product = await _repository.GetByIdAsync(id);\n\n    if (product == null)\n        throw new ProductNotFoundException(id);\n\n    return product;\n}\n</code></pre>"},{"location":"domain/exceptions/#suppliernotfoundexception","title":"SupplierNotFoundException","text":"<pre><code>public class SupplierNotFoundException : DomainException\n{\n    public Guid SupplierId { get; }\n\n    public SupplierNotFoundException(Guid supplierId) \n        : base($\"Fournisseur avec l'ID '{supplierId}' introuvable.\")\n    {\n        SupplierId = supplierId;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#usernotfoundexception","title":"UserNotFoundException","text":"<pre><code>public class UserNotFoundException : DomainException\n{\n    public Guid UserId { get; }\n\n    public UserNotFoundException(Guid userId) \n        : base($\"Utilisateur avec l'ID '{userId}' introuvable.\")\n    {\n        UserId = userId;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#ordernotfoundexception","title":"OrderNotFoundException","text":"<pre><code>public class OrderNotFoundException : DomainException\n{\n    public Guid OrderId { get; }\n\n    public OrderNotFoundException(Guid orderId) \n        : base($\"Commande avec l'ID '{orderId}' introuvable.\")\n    {\n        OrderId = orderId;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#hierarchie-des-exceptions","title":"Hi\u00e9rarchie des exceptions","text":"<pre><code>// Exception de base pour le Domain\npublic abstract class DomainException : Exception\n{\n    protected DomainException(string message) \n        : base(message)\n    {\n    }\n\n    protected DomainException(string message, Exception innerException) \n        : base(message, innerException)\n    {\n    }\n}\n</code></pre> <pre><code>graph TB\n    EX[Exception .NET] --&gt; DOMEX[DomainException]\n    DOMEX --&gt; PRICE[InvalidPriceException]\n    DOMEX --&gt; VAT[InvalidVatException]\n    DOMEX --&gt; PROD[ProductNotFoundException]\n    DOMEX --&gt; SUP[SupplierNotFoundException]\n    DOMEX --&gt; USER[UserNotFoundException]\n    DOMEX --&gt; ORD[OrderNotFoundException]</code></pre>"},{"location":"domain/exceptions/#gestion-des-exceptions","title":"Gestion des exceptions","text":""},{"location":"domain/exceptions/#dans-le-domain","title":"Dans le Domain","text":"<p>Le Domain l\u00e8ve les exceptions :</p> <pre><code>public class Product\n{\n    public void UpdatePrice(Price newPrice)\n    {\n        // Validation\n        if (newPrice == null)\n            throw new ArgumentNullException(nameof(newPrice));\n\n        Price = newPrice;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#dans-lapplication","title":"Dans l'Application","text":"<p>L'Application propage ou transforme :</p> <pre><code>public class ProductService\n{\n    public async Task&lt;ProductDto&gt; UpdatePriceAsync(Guid id, decimal newPrice)\n    {\n        try\n        {\n            var product = await _repository.GetByIdAsync(id);\n            if (product == null)\n                throw new ProductNotFoundException(id);\n\n            var price = new Price(newPrice);  // Peut lever InvalidPriceException\n            product.UpdatePrice(price);\n\n            await _repository.UpdateAsync(product);\n            return MapToDto(product);\n        }\n        catch (DomainException)\n        {\n            // Propager les exceptions m\u00e9tier\n            throw;\n        }\n        catch (Exception ex)\n        {\n            // Transformer les autres en ApplicationServiceException\n            throw new ApplicationServiceException(\"Erreur lors de la mise \u00e0 jour du prix\", ex);\n        }\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#dans-lapi","title":"Dans l'API","text":"<p>Le middleware capture et transforme en r\u00e9ponses HTTP :</p> <pre><code>private static Task HandleExceptionAsync(HttpContext context, Exception exception)\n{\n    var statusCode = exception switch\n    {\n        ProductNotFoundException =&gt; StatusCodes.Status404NotFound,\n        InvalidPriceException =&gt; StatusCodes.Status400BadRequest,\n        InvalidVatException =&gt; StatusCodes.Status400BadRequest,\n        DomainException =&gt; StatusCodes.Status400BadRequest,\n        _ =&gt; StatusCodes.Status500InternalServerError\n    };\n\n    context.Response.StatusCode = statusCode;\n\n    return context.Response.WriteAsJsonAsync(new\n    {\n        message = exception.Message\n    });\n}\n</code></pre>"},{"location":"domain/exceptions/#flow-des-exceptions","title":"Flow des exceptions","text":"<pre><code>sequenceDiagram\n    participant C as Controller\n    participant S as Service\n    participant D as Domain/Repository\n    participant M as Middleware\n\n    C-&gt;&gt;S: UpdatePrice(id, price)\n    S-&gt;&gt;D: new Price(-50)\n    D-&gt;&gt;D: Validation\n    D--&gt;&gt;S: throw InvalidPriceException\n    S--&gt;&gt;C: throw InvalidPriceException\n    C--&gt;&gt;M: Exception propag\u00e9e\n    M-&gt;&gt;M: HandleException\n    M--&gt;&gt;C: 400 Bad Request</code></pre>"},{"location":"domain/exceptions/#best-practices","title":"Best Practices","text":""},{"location":"domain/exceptions/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Cr\u00e9er des exceptions sp\u00e9cifiques par r\u00e8gle m\u00e9tier</li> <li>Inclure des informations contextuelles (ID, valeurs)</li> <li>H\u00e9riter de <code>DomainException</code> pour les exceptions m\u00e9tier</li> <li>Propager les exceptions m\u00e9tier sans les wrapper</li> </ul>"},{"location":"domain/exceptions/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Exceptions g\u00e9n\u00e9riques (<code>Exception</code>, <code>InvalidOperationException</code>)</li> <li>Messages d'erreur techniques pour l'utilisateur</li> <li>Capturer et ignorer les exceptions</li> <li>Logique m\u00e9tier dans les catch</li> </ul>"},{"location":"domain/exceptions/#exemples-dutilisation","title":"Exemples d'utilisation","text":""},{"location":"domain/exceptions/#validation-dans-value-object","title":"Validation dans Value Object","text":"<pre><code>public class Price\n{\n    public Price(decimal value)\n    {\n        if (value &lt;= 0)\n            throw new InvalidPriceException(value);\n\n        Value = value;\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#validation-dans-entity","title":"Validation dans Entity","text":"<pre><code>public class Order\n{\n    public void AddLine(OrderLine line)\n    {\n        if (line == null)\n            throw new ArgumentNullException(nameof(line));\n\n        if (line.Quantity &lt;= 0)\n            throw new InvalidOrderLineException(\"La quantit\u00e9 doit \u00eatre positive\");\n\n        OrderLines.Add(line);\n    }\n}\n</code></pre>"},{"location":"domain/exceptions/#validation-dans-repository","title":"Validation dans Repository","text":"<pre><code>public async Task&lt;Product&gt; GetByIdAsync(Guid id)\n{\n    var product = _products.FirstOrDefault(p =&gt; p.Id == id);\n\n    if (product == null)\n        throw new ProductNotFoundException(id);\n\n    return product;\n}\n</code></pre>"},{"location":"domain/exceptions/#navigation","title":"Navigation","text":"<ul> <li>Retour au Domain \u2192</li> <li>Value Objects \u2192</li> <li>Exceptions Application \u2192</li> </ul>"},{"location":"domain/interfaces/","title":"Interfaces","text":""},{"location":"domain/interfaces/#domain-interfaces","title":"Domain - Interfaces","text":""},{"location":"domain/interfaces/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les interfaces d\u00e9finissent les contrats que l'Infrastructure doit impl\u00e9menter, respectant le principe d'inversion de d\u00e9pendance.</p>"},{"location":"domain/interfaces/#pattern-repository","title":"Pattern Repository","text":"<p>Les interfaces de repositories sont d\u00e9finies dans le Domain mais impl\u00e9ment\u00e9es dans l'Infrastructure.</p>"},{"location":"domain/interfaces/#iproductrepository","title":"IProductRepository","text":"<pre><code>public interface IProductRepository\n{\n    /// &lt;summary&gt;\n    /// R\u00e9cup\u00e8re tous les produits\n    /// &lt;/summary&gt;\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync();\n\n    /// &lt;summary&gt;\n    /// R\u00e9cup\u00e8re un produit par son identifiant\n    /// &lt;/summary&gt;\n    Task&lt;Product?&gt; GetByIdAsync(Guid id);\n\n    /// &lt;summary&gt;\n    /// Ajoute un nouveau produit\n    /// &lt;/summary&gt;\n    Task AddAsync(Product product);\n\n    /// &lt;summary&gt;\n    /// Met \u00e0 jour un produit existant\n    /// &lt;/summary&gt;\n    Task UpdateAsync(Product product);\n\n    /// &lt;summary&gt;\n    /// Supprime un produit\n    /// &lt;/summary&gt;\n    Task DeleteAsync(Guid id);\n}\n</code></pre>"},{"location":"domain/interfaces/#isupplierrepository","title":"ISupplierRepository","text":"<pre><code>public interface ISupplierRepository\n{\n    Task&lt;IEnumerable&lt;Supplier&gt;&gt; GetAllAsync();\n    Task&lt;Supplier?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(Supplier supplier);\n    Task UpdateAsync(Supplier supplier);\n    Task DeleteAsync(Guid id);\n}\n</code></pre>"},{"location":"domain/interfaces/#iuserrepository","title":"IUserRepository","text":"<pre><code>public interface IUserRepository\n{\n    Task&lt;IEnumerable&lt;User&gt;&gt; GetAllAsync();\n    Task&lt;User?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(User user);\n    Task UpdateAsync(User user);\n    Task DeleteAsync(Guid id);\n}\n</code></pre>"},{"location":"domain/interfaces/#iorderrepository","title":"IOrderRepository","text":"<pre><code>public interface IOrderRepository\n{\n    Task&lt;IEnumerable&lt;Order&gt;&gt; GetAllAsync();\n    Task&lt;Order?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(Order order);\n    Task UpdateAsync(Order order);\n    Task DeleteAsync(Guid id);\n\n    // M\u00e9thodes sp\u00e9cifiques aux commandes\n    Task&lt;IEnumerable&lt;Order&gt;&gt; GetByUserIdAsync(Guid userId);\n    Task&lt;IEnumerable&lt;Order&gt;&gt; GetByDateRangeAsync(DateTime start, DateTime end);\n}\n</code></pre>"},{"location":"domain/interfaces/#principe-dinversion-de-dependance-dip","title":"Principe d'Inversion de D\u00e9pendance (DIP)","text":"<pre><code>graph TB\n    subgraph \"Domain (Abstractions)\"\n        IREPO[IProductRepository&lt;br/&gt;Interface]\n        ENT[Product&lt;br/&gt;Entity]\n    end\n\n    subgraph \"Infrastructure (Impl\u00e9mentation)\"\n        REPO[EfProductRepository&lt;br/&gt;Impl\u00e9mentation]\n    end\n\n    subgraph \"Application\"\n        SVC[ProductService]\n    end\n\n    REPO -.-&gt;|Impl\u00e9mente| IREPO\n    REPO --&gt; ENT\n    SVC --&gt; IREPO\n    SVC --&gt; ENT\n\n    style IREPO fill:#4CAF50,color:#fff\n    style ENT fill:#4CAF50,color:#fff</code></pre> <p>Avantage : Le Domain et l'Application ne d\u00e9pendent jamais de l'Infrastructure.</p>"},{"location":"domain/interfaces/#generic-repository-pattern-optionnel","title":"Generic Repository Pattern (optionnel)","text":"<p>Pour \u00e9viter la r\u00e9p\u00e9tition, on peut cr\u00e9er une interface g\u00e9n\u00e9rique :</p> <pre><code>public interface IRepository&lt;T&gt; where T : class\n{\n    Task&lt;IEnumerable&lt;T&gt;&gt; GetAllAsync();\n    Task&lt;T?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(T entity);\n    Task UpdateAsync(T entity);\n    Task DeleteAsync(Guid id);\n}\n\n// Puis sp\u00e9cialiser\npublic interface IProductRepository : IRepository&lt;Product&gt;\n{\n    // M\u00e9thodes sp\u00e9cifiques aux produits\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetBySupplierId(Guid supplierId);\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetActiveProducts();\n}\n</code></pre>"},{"location":"domain/interfaces/#utilisation-dans-les-services","title":"Utilisation dans les Services","text":"<pre><code>public class ProductService\n{\n    // D\u00e9pendance sur l'interface, pas l'impl\u00e9mentation\n    private readonly IProductRepository _repository;\n\n    public ProductService(IProductRepository repository)\n    {\n        _repository = repository;\n    }\n\n    public async Task&lt;IEnumerable&lt;ProductDto&gt;&gt; GetAllAsync()\n    {\n        // Le service ne sait pas comment les donn\u00e9es sont stock\u00e9es\n        var products = await _repository.GetAllAsync();\n        return products.Select(MapToDto);\n    }\n}\n</code></pre>"},{"location":"domain/interfaces/#injection-de-dependances","title":"Injection de D\u00e9pendances","text":"<p>Dans <code>Program.cs</code> :</p> <pre><code>// Enregistrement de l'impl\u00e9mentation pour l'interface\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\nbuilder.Services.AddScoped&lt;ISupplierRepository, EfSupplierRepository&gt;();\nbuilder.Services.AddScoped&lt;IUserRepository, EfUserRepository&gt;();\nbuilder.Services.AddScoped&lt;IOrderRepository, EfOrderRepository&gt;();\n</code></pre> <p>ASP.NET Core injecte automatiquement les bonnes impl\u00e9mentations.</p>"},{"location":"domain/interfaces/#avantages-du-pattern","title":"Avantages du pattern","text":""},{"location":"domain/interfaces/#1-testabilite","title":"1. Testabilit\u00e9","text":"<pre><code>// Dans les tests, on peut mocker l'interface\nvar mockRepo = new Mock&lt;IProductRepository&gt;();\nmockRepo.Setup(r =&gt; r.GetAllAsync())\n    .ReturnsAsync(new List&lt;Product&gt; { testProduct });\n\nvar service = new ProductService(mockRepo.Object);\nvar result = await service.GetAllAsync();\n\n// Test sans toucher \u00e0 la vraie base de donn\u00e9es\n</code></pre>"},{"location":"domain/interfaces/#2-flexibilite","title":"2. Flexibilit\u00e9","text":"<p>On peut changer d'impl\u00e9mentation sans modifier le code m\u00e9tier :</p> <pre><code>// Production : Entity Framework\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\n\n// Tests : In-Memory\nbuilder.Services.AddScoped&lt;IProductRepository, InMemoryProductRepository&gt;();\n\n// Alternative : Dapper\nbuilder.Services.AddScoped&lt;IProductRepository, DapperProductRepository&gt;();\n</code></pre>"},{"location":"domain/interfaces/#3-separation-des-responsabilites","title":"3. S\u00e9paration des responsabilit\u00e9s","text":"<ul> <li>Domain : D\u00e9finit le contrat</li> <li>Infrastructure : Impl\u00e9mente le contrat</li> <li>Application : Utilise le contrat</li> </ul>"},{"location":"domain/interfaces/#cqrs-optionnel","title":"CQRS (optionnel)","text":"<p>Pour des applications plus complexes, on peut s\u00e9parer lecture et \u00e9criture :</p> <pre><code>// Commandes (\u00e9criture)\npublic interface IProductCommandRepository\n{\n    Task AddAsync(Product product);\n    Task UpdateAsync(Product product);\n    Task DeleteAsync(Guid id);\n}\n\n// Queries (lecture)\npublic interface IProductQueryRepository\n{\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync();\n    Task&lt;Product?&gt; GetByIdAsync(Guid id);\n}\n</code></pre>"},{"location":"domain/interfaces/#unit-of-work-pattern-optionnel","title":"Unit of Work Pattern (optionnel)","text":"<p>Pour g\u00e9rer les transactions :</p> <pre><code>public interface IUnitOfWork : IDisposable\n{\n    IProductRepository Products { get; }\n    ISupplierRepository Suppliers { get; }\n    IOrderRepository Orders { get; }\n\n    Task&lt;int&gt; SaveChangesAsync();\n}\n</code></pre>"},{"location":"domain/interfaces/#navigation","title":"Navigation","text":"<ul> <li>Retour au Domain \u2192</li> <li>Entit\u00e9s \u2192</li> <li>Repositories (Infrastructure) \u2192</li> </ul>"},{"location":"domain/value-objects/","title":"Value Objects","text":""},{"location":"domain/value-objects/#domain-value-objects","title":"Domain - Value Objects","text":""},{"location":"domain/value-objects/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les Value Objects sont des objets immuables d\u00e9finis uniquement par leurs valeurs, sans identit\u00e9 propre.</p>"},{"location":"domain/value-objects/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>\u2705 Immuables : Ne peuvent pas \u00eatre modifi\u00e9s apr\u00e8s cr\u00e9ation</li> <li>\u2705 \u00c9galit\u00e9 par valeur : Deux objets avec les m\u00eames valeurs sont \u00e9gaux</li> <li>\u2705 Validation : Garantissent toujours un \u00e9tat valide</li> <li>\u2705 Pas d'identit\u00e9 : Pas de Guid ou Id</li> </ul>"},{"location":"domain/value-objects/#value-objects-disponibles","title":"Value Objects disponibles","text":""},{"location":"domain/value-objects/#price","title":"Price","text":"<p>Repr\u00e9sente un prix avec validation.</p> <pre><code>public class Price\n{\n    public decimal Value { get; }\n\n    public Price(decimal value)\n    {\n        if (value &lt;= 0)\n            throw new InvalidPriceException(\"Le prix doit \u00eatre strictement positif\");\n\n        Value = value;\n    }\n\n    // \u00c9galit\u00e9 par valeur\n    public override bool Equals(object? obj)\n    {\n        return obj is Price other &amp;&amp; Value == other.Value;\n    }\n\n    public override int GetHashCode() =&gt; Value.GetHashCode();\n\n    // Op\u00e9rateurs\n    public static bool operator ==(Price left, Price right) =&gt; left.Equals(right);\n    public static bool operator !=(Price left, Price right) =&gt; !left.Equals(right);\n}\n</code></pre> <p>Invariant : Le prix doit toujours \u00eatre strictement positif.</p>"},{"location":"domain/value-objects/#vat-tva","title":"VAT (TVA)","text":"<p>Repr\u00e9sente un taux de TVA.</p> <pre><code>public class VAT\n{\n    public decimal Rate { get; }\n\n    public VAT(decimal rate)\n    {\n        if (rate &lt; 0 || rate &gt; 100)\n            throw new InvalidVatException(\"Le taux de TVA doit \u00eatre entre 0 et 100\");\n\n        Rate = rate;\n    }\n\n    public decimal CalculateTax(Price price)\n    {\n        return price.Value * (Rate / 100);\n    }\n\n    public decimal CalculatePriceIncludingTax(Price price)\n    {\n        return price.Value * (1 + Rate / 100);\n    }\n}\n</code></pre> <p>Invariant : Le taux doit \u00eatre entre 0 et 100%.</p>"},{"location":"domain/value-objects/#email-exemple-possible","title":"Email (exemple possible)","text":"<pre><code>public class Email\n{\n    public string Value { get; }\n\n    public Email(string value)\n    {\n        if (string.IsNullOrWhiteSpace(value))\n            throw new ArgumentException(\"L'email ne peut pas \u00eatre vide\");\n\n        if (!IsValidEmail(value))\n            throw new ArgumentException(\"Format d'email invalide\");\n\n        Value = value.ToLowerInvariant();\n    }\n\n    private static bool IsValidEmail(string email)\n    {\n        return Regex.IsMatch(email, @\"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$\");\n    }\n}\n</code></pre>"},{"location":"domain/value-objects/#avantages-des-value-objects","title":"Avantages des Value Objects","text":""},{"location":"domain/value-objects/#1-encapsulation-de-la-validation","title":"1. Encapsulation de la validation","text":"<pre><code>// \u274c Sans Value Object\npublic class Product\n{\n    public decimal Price { get; set; }\n\n    public void UpdatePrice(decimal newPrice)\n    {\n        // Validation \u00e0 r\u00e9p\u00e9ter partout\n        if (newPrice &lt;= 0)\n            throw new Exception(\"Prix invalide\");\n        Price = newPrice;\n    }\n}\n\n// \u2705 Avec Value Object\npublic class Product\n{\n    public Price Price { get; private set; }\n\n    public void UpdatePrice(Price newPrice)\n    {\n        // La validation est dans Price\n        Price = newPrice;  // Toujours valide !\n    }\n}\n</code></pre>"},{"location":"domain/value-objects/#2-semantique-metier","title":"2. S\u00e9mantique m\u00e9tier","text":"<pre><code>// \u274c Perte de s\u00e9mantique\npublic decimal CalculateTax(decimal price, decimal vatRate)\n{\n    return price * vatRate / 100;\n}\n\n// \u2705 S\u00e9mantique claire\npublic decimal CalculateTax(Price price, VAT vat)\n{\n    return vat.CalculateTax(price);\n}\n</code></pre>"},{"location":"domain/value-objects/#3-immuabilite","title":"3. Immuabilit\u00e9","text":"<pre><code>var price1 = new Price(100);\nvar price2 = price1;  // M\u00eame r\u00e9f\u00e9rence\n\n// Impossible de modifier price1 ou price2\n// Pour changer, il faut cr\u00e9er un nouveau Price\nvar newPrice = new Price(150);\n</code></pre>"},{"location":"domain/value-objects/#egalite-par-valeur","title":"\u00c9galit\u00e9 par valeur","text":""},{"location":"domain/value-objects/#implementation","title":"Impl\u00e9mentation","text":"<pre><code>public class Price : IEquatable&lt;Price&gt;\n{\n    public decimal Value { get; }\n\n    // Equals\n    public bool Equals(Price? other)\n    {\n        if (other is null) return false;\n        return Value == other.Value;\n    }\n\n    public override bool Equals(object? obj)\n    {\n        return Equals(obj as Price);\n    }\n\n    // GetHashCode\n    public override int GetHashCode()\n    {\n        return Value.GetHashCode();\n    }\n\n    // Op\u00e9rateurs\n    public static bool operator ==(Price? left, Price? right)\n    {\n        if (left is null) return right is null;\n        return left.Equals(right);\n    }\n\n    public static bool operator !=(Price? left, Price? right)\n    {\n        return !(left == right);\n    }\n}\n</code></pre>"},{"location":"domain/value-objects/#utilisation","title":"Utilisation","text":"<pre><code>var price1 = new Price(100);\nvar price2 = new Price(100);\n\nConsole.WriteLine(price1 == price2);  // True (\u00e9galit\u00e9 par valeur)\nConsole.WriteLine(price1.Equals(price2));  // True\n\nvar price3 = new Price(150);\nConsole.WriteLine(price1 == price3);  // False\n</code></pre>"},{"location":"domain/value-objects/#records-c-9","title":"Records (C# 9+)","text":"<p>Alternative moderne pour les Value Objects simples :</p> <pre><code>public record Price(decimal Value)\n{\n    public Price(decimal Value) : this(Value)\n    {\n        if (Value &lt;= 0)\n            throw new InvalidPriceException(\"Le prix doit \u00eatre strictement positif\");\n    }\n}\n\n// Immuabilit\u00e9 et \u00e9galit\u00e9 par valeur automatiques\nvar p1 = new Price(100);\nvar p2 = new Price(100);\nConsole.WriteLine(p1 == p2);  // True\n</code></pre>"},{"location":"domain/value-objects/#value-objects-vs-primitives","title":"Value Objects vs Primitives","text":"Primitive (decimal, string) Value Object (Price, Email) Pas de validation Validation garantie Pas de s\u00e9mantique S\u00e9mantique m\u00e9tier claire Facile \u00e0 mal utiliser Impossible d'avoir un \u00e9tat invalide <code>decimal price</code> <code>Price price</code>"},{"location":"domain/value-objects/#pattern-utilise-primitive-obsession","title":"Pattern utilis\u00e9 : Primitive Obsession","text":"<p>Probl\u00e8me : Utiliser trop de types primitifs.</p> <pre><code>// \u274c Primitive Obsession\npublic void CreateProduct(string name, decimal price, decimal vatRate)\n{\n    // Qu'est-ce qu'un decimal valide pour le prix ?\n    // Et pour la TVA ?\n}\n\n// \u2705 Value Objects\npublic void CreateProduct(string name, Price price, VAT vat)\n{\n    // Les types portent la s\u00e9mantique\n    // Les valeurs sont garanties valides\n}\n</code></pre>"},{"location":"domain/value-objects/#navigation","title":"Navigation","text":"<ul> <li>Retour au Domain \u2192</li> <li>Entit\u00e9s \u2192</li> <li>Exceptions \u2192</li> </ul>"},{"location":"infrastructure/configuration/","title":"Configuration","text":""},{"location":"infrastructure/configuration/#infrastructure-configuration","title":"Infrastructure - Configuration","text":""},{"location":"infrastructure/configuration/#vue-densemble","title":"Vue d'ensemble","text":"<p>Cette page documente la configuration future de l'infrastructure avec Entity Framework Core.</p>"},{"location":"infrastructure/configuration/#etat-actuel","title":"\u00c9tat actuel","text":"<p>\u26a0\ufe0f Actuellement : Les repositories utilisent des collections en m\u00e9moire (<code>List&lt;T&gt;</code>).</p> <p>\u27a1\ufe0f Future : Migration vers Entity Framework Core avec une vraie base de donn\u00e9es.</p>"},{"location":"infrastructure/configuration/#configuration-entity-framework-core-future","title":"Configuration Entity Framework Core (future)","text":""},{"location":"infrastructure/configuration/#connexion-a-la-base-de-donnees","title":"Connexion \u00e0 la base de donn\u00e9es","text":"<p>appsettings.json :</p> <pre><code>{\n  \"ConnectionStrings\": {\n    \"DefaultConnection\": \"Server=(localdb)\\\\mssqllocaldb;Database=AdvancedDevSampleDb;Trusted_Connection=True;\"\n  }\n}\n</code></pre>"},{"location":"infrastructure/configuration/#dbcontext","title":"DbContext","text":"<pre><code>public class AppDbContext : DbContext\n{\n    public DbSet&lt;Product&gt; Products { get; set; }\n    public DbSet&lt;Supplier&gt; Suppliers { get; set; }\n    public DbSet&lt;User&gt; Users { get; set; }\n    public DbSet&lt;Order&gt; Orders { get; set; }\n    public DbSet&lt;OrderLine&gt; OrderLines { get; set; }\n\n    public AppDbContext(DbContextOptions&lt;AppDbContext&gt; options) \n        : base(options)\n    {\n    }\n\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        ConfigureProduct(modelBuilder);\n        ConfigureSupplier(modelBuilder);\n        ConfigureUser(modelBuilder);\n        ConfigureOrder(modelBuilder);\n    }\n\n    private static void ConfigureProduct(ModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;Product&gt;(entity =&gt;\n        {\n            entity.HasKey(p =&gt; p.Id);\n\n            // Value Objects as Owned Entities\n            entity.OwnsOne(p =&gt; p.Price, price =&gt;\n            {\n                price.Property(p =&gt; p.Value).HasColumnName(\"Price\");\n            });\n\n            entity.OwnsOne(p =&gt; p.Vat, vat =&gt;\n            {\n                vat.Property(v =&gt; v.Rate).HasColumnName(\"VatRate\");\n            });\n\n            // Relations\n            entity.HasOne&lt;Supplier&gt;()\n                .WithMany()\n                .HasForeignKey(p =&gt; p.SupplierId);\n        });\n    }\n\n    // Autres configurations...\n}\n</code></pre>"},{"location":"infrastructure/configuration/#enregistrement-dans-programcs","title":"Enregistrement dans Program.cs","text":"<pre><code>// Configuration EF Core\nbuilder.Services.AddDbContext&lt;AppDbContext&gt;(options =&gt;\n    options.UseSqlServer(\n        builder.Configuration.GetConnectionString(\"DefaultConnection\")\n    )\n);\n\n// Repositories\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\nbuilder.Services.AddScoped&lt;ISupplierRepository, EfSupplierRepository&gt;();\nbuilder.Services.AddScoped&lt;IUserRepository, EfUserRepository&gt;();\nbuilder.Services.AddScoped&lt;IOrderRepository, EfOrderRepository&gt;();\n</code></pre>"},{"location":"infrastructure/configuration/#migrations","title":"Migrations","text":""},{"location":"infrastructure/configuration/#creer-une-migration","title":"Cr\u00e9er une migration","text":"<pre><code>dotnet ef migrations add InitialCreate\n</code></pre>"},{"location":"infrastructure/configuration/#appliquer-la-migration","title":"Appliquer la migration","text":"<pre><code>dotnet ef database update\n</code></pre>"},{"location":"infrastructure/configuration/#supprimer-la-derniere-migration","title":"Supprimer la derni\u00e8re migration","text":"<pre><code>dotnet ef migrations remove\n</code></pre>"},{"location":"infrastructure/configuration/#seed-data-donnees-initiales","title":"Seed Data (donn\u00e9es initiales)","text":"<pre><code>public static class DbInitializer\n{\n    public static void Initialize(AppDbContext context)\n    {\n        context.Database.EnsureCreated();\n\n        if (context.Products.Any())\n            return;  // DB d\u00e9j\u00e0 initialis\u00e9e\n\n        var suppliers = new[]\n        {\n            new Supplier(\"Dell Inc.\", \"contact@dell.com\", \"+1234567890\"),\n            new Supplier(\"HP Inc.\", \"contact@hp.com\", \"+0987654321\")\n        };\n\n        context.Suppliers.AddRange(suppliers);\n        context.SaveChanges();\n\n        var products = new[]\n        {\n            new Product(\"Laptop Dell XPS 15\", \"High performance\", new Price(1299.99m), new VAT(20), suppliers[0].Id),\n            new Product(\"HP EliteBook\", \"Business laptop\", new Price(999.99m), new VAT(20), suppliers[1].Id)\n        };\n\n        context.Products.AddRange(products);\n        context.SaveChanges();\n    }\n}\n\n// Dans Program.cs\nusing (var scope = app.Services.CreateScope())\n{\n    var context = scope.ServiceProvider.GetRequiredService&lt;AppDbContext&gt;();\n    DbInitializer.Initialize(context);\n}\n</code></pre>"},{"location":"infrastructure/configuration/#choix-de-base-de-donnees","title":"Choix de base de donn\u00e9es","text":""},{"location":"infrastructure/configuration/#sql-server","title":"SQL Server","text":"<pre><code>dotnet add package Microsoft.EntityFrameworkCore.SqlServer\n</code></pre> <pre><code>options.UseSqlServer(connectionString)\n</code></pre>"},{"location":"infrastructure/configuration/#postgresql","title":"PostgreSQL","text":"<pre><code>dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL\n</code></pre> <pre><code>options.UseNpgsql(connectionString)\n</code></pre>"},{"location":"infrastructure/configuration/#sqlite-pour-developpement","title":"SQLite (pour d\u00e9veloppement)","text":"<pre><code>dotnet add package Microsoft.EntityFrameworkCore.Sqlite\n</code></pre> <pre><code>options.UseSqlite(\"Data Source=app.db\")\n</code></pre>"},{"location":"infrastructure/configuration/#configuration-avancee","title":"Configuration avanc\u00e9e","text":""},{"location":"infrastructure/configuration/#logging-des-requetes-sql","title":"Logging des requ\u00eates SQL","text":"<pre><code>builder.Services.AddDbContext&lt;AppDbContext&gt;(options =&gt;\n{\n    options.UseSqlServer(connectionString);\n    options.EnableSensitiveDataLogging();  // Uniquement en d\u00e9veloppement\n    options.LogTo(Console.WriteLine, LogLevel.Information);\n});\n</code></pre>"},{"location":"infrastructure/configuration/#strategie-de-retry","title":"Strat\u00e9gie de retry","text":"<pre><code>options.UseSqlServer(\n    connectionString,\n    sqlOptions =&gt; sqlOptions.EnableRetryOnFailure(\n        maxRetryCount: 5,\n        maxRetryDelay: TimeSpan.FromSeconds(30),\n        errorNumbersToAdd: null\n    )\n);\n</code></pre>"},{"location":"infrastructure/configuration/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 Infrastructure \u2192</li> <li>Repositories \u2192</li> </ul>"},{"location":"infrastructure/repositories/","title":"Repositories","text":""},{"location":"infrastructure/repositories/#infrastructure-repositories","title":"Infrastructure - Repositories","text":""},{"location":"infrastructure/repositories/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les repositories sont les impl\u00e9mentations concr\u00e8tes des interfaces d\u00e9finies dans le Domain pour la persistance des donn\u00e9es.</p>"},{"location":"infrastructure/repositories/#etat-actuel-in-memory","title":"\u00c9tat actuel : In-Memory","text":"<p>\u26a0\ufe0f Important : Actuellement, les repositories utilisent des collections en m\u00e9moire (<code>List&lt;T&gt;</code>).</p> <p>Les donn\u00e9es sont perdues au red\u00e9marrage de l'application.</p>"},{"location":"infrastructure/repositories/#repositories-disponibles","title":"Repositories disponibles","text":""},{"location":"infrastructure/repositories/#efproductrepository","title":"EfProductRepository","text":"<p>Gestion de la persistance des produits.</p> <pre><code>public class EfProductRepository : IProductRepository\n{\n    private readonly List&lt;Product&gt; _products = new();\n\n    public async Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync()\n    {\n        return await Task.FromResult(_products.AsEnumerable());\n    }\n\n    public async Task&lt;Product?&gt; GetByIdAsync(Guid id)\n    {\n        return await Task.FromResult(_products.FirstOrDefault(p =&gt; p.Id == id));\n    }\n\n    public async Task AddAsync(Product product)\n    {\n        _products.Add(product);\n        await Task.CompletedTask;\n    }\n\n    public async Task UpdateAsync(Product product)\n    {\n        var existing = _products.FirstOrDefault(p =&gt; p.Id == product.Id);\n        if (existing != null)\n        {\n            _products.Remove(existing);\n            _products.Add(product);\n        }\n        await Task.CompletedTask;\n    }\n\n    public async Task DeleteAsync(Guid id)\n    {\n        var product = _products.FirstOrDefault(p =&gt; p.Id == id);\n        if (product != null)\n        {\n            _products.Remove(product);\n        }\n        await Task.CompletedTask;\n    }\n}\n</code></pre>"},{"location":"infrastructure/repositories/#efsupplierrepository","title":"EfSupplierRepository","text":"<pre><code>public class EfSupplierRepository : ISupplierRepository\n{\n    private readonly List&lt;Supplier&gt; _suppliers = new();\n\n    // M\u00eames m\u00e9thodes CRUD\n}\n</code></pre>"},{"location":"infrastructure/repositories/#efuserrepository","title":"EfUserRepository","text":"<pre><code>public class EfUserRepository : IUserRepository\n{\n    private readonly List&lt;User&gt; _users = new();\n\n    // M\u00eames m\u00e9thodes CRUD\n}\n</code></pre>"},{"location":"infrastructure/repositories/#eforderrepository","title":"EfOrderRepository","text":"<pre><code>public class EfOrderRepository : IOrderRepository\n{\n    private readonly List&lt;Order&gt; _orders = new();\n\n    // M\u00eames m\u00e9thodes CRUD + m\u00e9thodes sp\u00e9cifiques\n\n    public async Task&lt;IEnumerable&lt;Order&gt;&gt; GetByUserIdAsync(Guid userId)\n    {\n        return await Task.FromResult(\n            _orders.Where(o =&gt; o.UserId == userId).ToList()\n        );\n    }\n}\n</code></pre>"},{"location":"infrastructure/repositories/#pattern-repository","title":"Pattern Repository","text":""},{"location":"infrastructure/repositories/#interface-domain","title":"Interface (Domain)","text":"<pre><code>// D\u00e9fini dans Domain/Interfaces\npublic interface IProductRepository\n{\n    Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync();\n    Task&lt;Product?&gt; GetByIdAsync(Guid id);\n    Task AddAsync(Product product);\n    Task UpdateAsync(Product product);\n    Task DeleteAsync(Guid id);\n}\n</code></pre>"},{"location":"infrastructure/repositories/#implementation-infrastructure","title":"Impl\u00e9mentation (Infrastructure)","text":"<pre><code>// Impl\u00e9ment\u00e9 dans Infrastructure/Repositories\npublic class EfProductRepository : IProductRepository\n{\n    // Impl\u00e9mentation concr\u00e8te\n}\n</code></pre>"},{"location":"infrastructure/repositories/#injection-de-dependances","title":"Injection de d\u00e9pendances","text":"<p>Dans <code>Program.cs</code> :</p> <pre><code>// L'application d\u00e9pend de l'interface\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\n\n// On peut facilement changer l'impl\u00e9mentation\n// builder.Services.AddScoped&lt;IProductRepository, DapperProductRepository&gt;();\n// builder.Services.AddScoped&lt;IProductRepository, MongoProductRepository&gt;();\n</code></pre>"},{"location":"infrastructure/repositories/#avantages-du-pattern","title":"Avantages du pattern","text":""},{"location":"infrastructure/repositories/#1-abstraction-de-la-persistance","title":"1. Abstraction de la persistance","text":"<pre><code>graph LR\n    SVC[ProductService] --&gt; IREPO[IProductRepository]\n    IREPO -.-&gt;|Impl\u00e9ment\u00e9 par| MEM[InMemoryRepository]\n    IREPO -.-&gt;|Pourrait \u00eatre| EF[EfCoreRepository]\n    IREPO -.-&gt;|Pourrait \u00eatre| DAPPER[DapperRepository]</code></pre>"},{"location":"infrastructure/repositories/#2-testabilite","title":"2. Testabilit\u00e9","text":"<pre><code>// Mock dans les tests\nvar mockRepo = new Mock&lt;IProductRepository&gt;();\nmockRepo.Setup(r =&gt; r.GetAllAsync()).ReturnsAsync(testProducts);\n\nvar service = new ProductService(mockRepo.Object);\n</code></pre>"},{"location":"infrastructure/repositories/#3-changement-de-technologie-facile","title":"3. Changement de technologie facile","text":"<p>Remplacer <code>List&lt;T&gt;</code> par Entity Framework Core ne n\u00e9cessite que de modifier les repositories.</p>"},{"location":"infrastructure/repositories/#migration-vers-entity-framework-core","title":"Migration vers Entity Framework Core","text":""},{"location":"infrastructure/repositories/#1-installer-les-packages","title":"1. Installer les packages","text":"<pre><code>dotnet add package Microsoft.EntityFrameworkCore\ndotnet add package Microsoft.EntityFrameworkCore.SqlServer\n</code></pre>"},{"location":"infrastructure/repositories/#2-creer-le-dbcontext","title":"2. Cr\u00e9er le DbContext","text":"<pre><code>public class AppDbContext : DbContext\n{\n    public DbSet&lt;Product&gt; Products { get; set; }\n    public DbSet&lt;Supplier&gt; Suppliers { get; set; }\n    public DbSet&lt;User&gt; Users { get; set; }\n    public DbSet&lt;Order&gt; Orders { get; set; }\n\n    public AppDbContext(DbContextOptions&lt;AppDbContext&gt; options) \n        : base(options)\n    {\n    }\n\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        // Configuration des entit\u00e9s\n        modelBuilder.Entity&lt;Product&gt;()\n            .OwnsOne(p =&gt; p.Price);\n\n        modelBuilder.Entity&lt;Product&gt;()\n            .OwnsOne(p =&gt; p.Vat);\n    }\n}\n</code></pre>"},{"location":"infrastructure/repositories/#3-modifier-le-repository","title":"3. Modifier le repository","text":"<pre><code>public class EfProductRepository : IProductRepository\n{\n    private readonly AppDbContext _context;\n\n    public EfProductRepository(AppDbContext context)\n    {\n        _context = context;\n    }\n\n    public async Task&lt;IEnumerable&lt;Product&gt;&gt; GetAllAsync()\n    {\n        return await _context.Products.ToListAsync();\n    }\n\n    public async Task&lt;Product?&gt; GetByIdAsync(Guid id)\n    {\n        return await _context.Products.FindAsync(id);\n    }\n\n    public async Task AddAsync(Product product)\n    {\n        await _context.Products.AddAsync(product);\n        await _context.SaveChangesAsync();\n    }\n\n    public async Task UpdateAsync(Product product)\n    {\n        _context.Products.Update(product);\n        await _context.SaveChangesAsync();\n    }\n\n    public async Task DeleteAsync(Guid id)\n    {\n        var product = await _context.Products.FindAsync(id);\n        if (product != null)\n        {\n            _context.Products.Remove(product);\n            await _context.SaveChangesAsync();\n        }\n    }\n}\n</code></pre>"},{"location":"infrastructure/repositories/#4-configurer-dans-programcs","title":"4. Configurer dans Program.cs","text":"<pre><code>builder.Services.AddDbContext&lt;AppDbContext&gt;(options =&gt;\n    options.UseSqlServer(\n        builder.Configuration.GetConnectionString(\"DefaultConnection\")\n    )\n);\n\nbuilder.Services.AddScoped&lt;IProductRepository, EfProductRepository&gt;();\n</code></pre>"},{"location":"infrastructure/repositories/#generic-repository-optionnel","title":"Generic Repository (optionnel)","text":"<p>Pour \u00e9viter la duplication :</p> <pre><code>public class GenericRepository&lt;T&gt; : IRepository&lt;T&gt; where T : class\n{\n    private readonly List&lt;T&gt; _entities = new();\n\n    public async Task&lt;IEnumerable&lt;T&gt;&gt; GetAllAsync()\n    {\n        return await Task.FromResult(_entities.AsEnumerable());\n    }\n\n    // ... autres m\u00e9thodes CRUD\n}\n\n// Utilisation\npublic class EfProductRepository : GenericRepository&lt;Product&gt;, IProductRepository\n{\n    // M\u00e9thodes sp\u00e9cifiques aux produits seulement\n}\n</code></pre>"},{"location":"infrastructure/repositories/#best-practices","title":"Best Practices","text":""},{"location":"infrastructure/repositories/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Un repository par agr\u00e9gat (Product, Order, etc.)</li> <li>M\u00e9thodes asynchrones (<code>async</code>/<code>await</code>)</li> <li>Injection du DbContext (quand EF Core)</li> <li>M\u00e9thodes sp\u00e9cifiques au domaine</li> </ul> <pre><code>Task&lt;IEnumerable&lt;Product&gt;&gt; GetActiveProducts();\nTask&lt;IEnumerable&lt;Product&gt;&gt; GetBySupplierId(Guid supplierId);\n</code></pre>"},{"location":"infrastructure/repositories/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Logique m\u00e9tier dans les repositories</li> <li>Exposition du DbContext \u00e0 l'ext\u00e9rieur</li> <li>Requ\u00eates LINQ complexes (\u00e0 mettre dans des m\u00e9thodes d\u00e9di\u00e9es)</li> </ul>"},{"location":"infrastructure/repositories/#navigation","title":"Navigation","text":"<ul> <li>Retour \u00e0 Infrastructure \u2192</li> <li>Interfaces (Domain) \u2192</li> <li>Configuration (future) \u2192</li> </ul>"},{"location":"tests/integration-tests/","title":"Tests d'Int\u00e9gration","text":""},{"location":"tests/integration-tests/#tests-tests-dintegration","title":"Tests - Tests d'Int\u00e9gration","text":""},{"location":"tests/integration-tests/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les tests d'int\u00e9gration v\u00e9rifient le fonctionnement de plusieurs composants ensemble, notamment l'API.</p>"},{"location":"tests/integration-tests/#webapplicationfactory","title":"WebApplicationFactory","text":"<p>Utilisation de <code>WebApplicationFactory&lt;Program&gt;</code> pour tester l'API en mode int\u00e9gration.</p> <pre><code>&lt;PackageReference Include=\"Microsoft.AspNetCore.Mvc.Testing\" Version=\"9.0.0\" /&gt;\n</code></pre>"},{"location":"tests/integration-tests/#configuration","title":"Configuration","text":"<pre><code>public class CustomWebApplicationFactory : WebApplicationFactory&lt;Program&gt;\n{\n    protected override void ConfigureWebHost(IWebHostBuilder builder)\n    {\n        builder.ConfigureServices(services =&gt;\n        {\n            // Remplacer les repositories par des impl\u00e9mentations de test\n            // si n\u00e9cessaire\n        });\n    }\n}\n</code></pre>"},{"location":"tests/integration-tests/#tests-des-controllers","title":"Tests des Controllers","text":"<pre><code>public class ProductControllerIntegrationTests : IClassFixture&lt;CustomWebApplicationFactory&gt;\n{\n    private readonly HttpClient _client;\n\n    public ProductControllerIntegrationTests(CustomWebApplicationFactory factory)\n    {\n        _client = factory.CreateClient();\n    }\n\n    [Fact]\n    public async Task GetAll_ShouldReturn200AndProducts()\n    {\n        // Act\n        var response = await _client.GetAsync(\"/api/products\");\n\n        // Assert\n        response.EnsureSuccessStatusCode();\n        Assert.Equal(HttpStatusCode.OK, response.StatusCode);\n\n        var content = await response.Content.ReadAsStringAsync();\n        Assert.NotEmpty(content);\n    }\n\n    [Fact]\n    public async Task Create_WithValidData_ShouldReturn201()\n    {\n        // Arrange\n        var dto = new\n        {\n            name = \"Test Product\",\n            description = \"Test Description\",\n            price = 99.99m,\n            vatRate = 20m,\n            supplierId = Guid.NewGuid()\n        };\n\n        var content = new StringContent(\n            JsonSerializer.Serialize(dto),\n            Encoding.UTF8,\n            \"application/json\"\n        );\n\n        // Act\n        var response = await _client.PostAsync(\"/api/products\", content);\n\n        // Assert\n        Assert.Equal(HttpStatusCode.Created, response.StatusCode);\n    }\n\n    [Fact]\n    public async Task Create_WithInvalidPrice_ShouldReturn400()\n    {\n        // Arrange\n        var dto = new\n        {\n            name = \"Test Product\",\n            description = \"Test Description\",\n            price = -50m,  // Prix invalide\n            vatRate = 20m,\n            supplierId = Guid.NewGuid()\n        };\n\n        var content = new StringContent(\n            JsonSerializer.Serialize(dto),\n            Encoding.UTF8,\n            \"application/json\"\n        );\n\n        // Act\n        var response = await _client.PostAsync(\"/api/products\", content);\n\n        // Assert\n        Assert.Equal(HttpStatusCode.BadRequest, response.StatusCode);\n    }\n}\n</code></pre>"},{"location":"tests/integration-tests/#tests-du-middleware","title":"Tests du Middleware","text":"<pre><code>[Fact]\npublic async Task ExceptionHandlingMiddleware_ShouldReturn500OnError()\n{\n    // Arrange\n    var invalidId = Guid.NewGuid();\n\n    // Act\n    var response = await _client.GetAsync($\"/api/products/{invalidId}\");\n\n    // Assert\n    Assert.Equal(HttpStatusCode.NotFound, response.StatusCode);\n\n    var content = await response.Content.ReadAsStringAsync();\n    Assert.Contains(\"introuvable\", content.ToLower());\n}\n</code></pre>"},{"location":"tests/integration-tests/#tests-du-rate-limiting","title":"Tests du Rate Limiting","text":"<pre><code>[Fact]\npublic async Task RateLimiting_ShouldReturn429AfterTooManyRequests()\n{\n    // Arrange\n    var tasks = new List&lt;Task&lt;HttpResponseMessage&gt;&gt;();\n\n    // Act - Envoyer 150 requ\u00eates rapidement\n    for (int i = 0; i &lt; 150; i++)\n    {\n        tasks.Add(_client.GetAsync(\"/api/products\"));\n    }\n\n    var responses = await Task.WhenAll(tasks);\n\n    // Assert - Au moins une devrait \u00eatre 429 (limite = 100/min)\n    Assert.Contains(responses, r =&gt; r.StatusCode == HttpStatusCode.TooManyRequests);\n}\n</code></pre>"},{"location":"tests/integration-tests/#execution","title":"Ex\u00e9cution","text":"<pre><code>dotnet test --filter \"Category=Integration\"\n</code></pre>"},{"location":"tests/integration-tests/#best-practices","title":"Best Practices","text":""},{"location":"tests/integration-tests/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Tester les endpoints complets</li> <li>V\u00e9rifier les codes de statut HTTP</li> <li>Tester la validation</li> <li>Tester les middlewares</li> </ul>"},{"location":"tests/integration-tests/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Tests lents (bases de donn\u00e9es r\u00e9elles)</li> <li>Tests qui modifient un \u00e9tat partag\u00e9</li> </ul>"},{"location":"tests/integration-tests/#navigation","title":"Navigation","text":"<ul> <li>Retour aux Tests \u2192</li> <li>Tests unitaires \u2192</li> </ul>"},{"location":"tests/unit-tests/","title":"Tests Unitaires","text":""},{"location":"tests/unit-tests/#tests-tests-unitaires","title":"Tests - Tests Unitaires","text":""},{"location":"tests/unit-tests/#vue-densemble","title":"Vue d'ensemble","text":"<p>Les tests unitaires v\u00e9rifient le comportement des composants individuels en isolation.</p>"},{"location":"tests/unit-tests/#framework-xunit","title":"Framework : xUnit","text":"<p>Le projet utilise xUnit comme framework de tests.</p> <pre><code>&lt;PackageReference Include=\"xunit\" Version=\"2.4.2\" /&gt;\n&lt;PackageReference Include=\"xunit.runner.visualstudio\" Version=\"2.4.5\" /&gt;\n&lt;PackageReference Include=\"Moq\" Version=\"4.18.4\" /&gt;\n</code></pre>"},{"location":"tests/unit-tests/#structure-des-tests","title":"Structure des tests","text":"<pre><code>AdvancedDevSample.Test/\n\u251c\u2500\u2500 Domain/               # Tests du Domain\n\u2502   \u251c\u2500\u2500 ProductTests.cs\n\u2502   \u251c\u2500\u2500 PriceTests.cs\n\u2502   \u2514\u2500\u2500 VATTests.cs\n\u251c\u2500\u2500 Application/          # Tests de l'Application\n\u2502   \u251c\u2500\u2500 ProductServiceTests.cs\n\u2502   \u251c\u2500\u2500 SupplierServiceTests.cs\n\u2502   \u2514\u2500\u2500 UserServiceTests.cs\n\u2514\u2500\u2500 API/                 # Tests de l'API\n    \u2514\u2500\u2500 Integration/\n</code></pre>"},{"location":"tests/unit-tests/#tests-du-domain","title":"Tests du Domain","text":""},{"location":"tests/unit-tests/#tests-des-value-objects","title":"Tests des Value Objects","text":"<pre><code>public class PriceTests\n{\n    [Fact]\n    public void Constructor_WithPositiveValue_ShouldCreatePrice()\n    {\n        // Arrange\n        decimal value = 100m;\n\n        // Act\n        var price = new Price(value);\n\n        // Assert\n        Assert.Equal(value, price.Value);\n    }\n\n    [Fact]\n    public void Constructor_WithNegativeValue_ShouldThrowException()\n    {\n        // Arrange\n        decimal value = -50m;\n\n        // Act &amp; Assert\n        Assert.Throws&lt;InvalidPriceException&gt;(() =&gt; new Price(value));\n    }\n\n    [Fact]\n    public void Constructor_WithZero_ShouldThrowException()\n    {\n        // Arrange\n        decimal value = 0m;\n\n        // Act &amp; Assert\n        Assert.Throws&lt;InvalidPriceException&gt;(() =&gt; new Price(value));\n    }\n}\n</code></pre>"},{"location":"tests/unit-tests/#tests-des-entites","title":"Tests des Entit\u00e9s","text":"<pre><code>public class ProductTests\n{\n    [Fact]\n    public void UpdatePrice_WithValidPrice_ShouldUpdatePrice()\n    {\n        // Arrange\n        var product = CreateTestProduct();\n        var newPrice = new Price(200m);\n\n        // Act\n        product.UpdatePrice(newPrice);\n\n        // Assert\n        Assert.Equal(200m, product.Price.Value);\n    }\n\n    [Fact]\n    public void Activate_ShouldSetIsActiveToTrue()\n    {\n        // Arrange\n        var product = CreateTestProduct();\n        product.Deactivate();\n\n        // Act\n        product.Activate();\n\n        // Assert\n        Assert.True(product.IsActive);\n    }\n\n    private static Product CreateTestProduct()\n    {\n        return new Product(\n            \"Test Product\",\n            \"Description\",\n            new Price(100m),\n            new VAT(20m),\n            Guid.NewGuid()\n        );\n    }\n}\n</code></pre>"},{"location":"tests/unit-tests/#tests-de-lapplication","title":"Tests de l'Application","text":""},{"location":"tests/unit-tests/#tests-des-services-avec-moq","title":"Tests des Services avec Moq","text":"<pre><code>public class ProductServiceTests\n{\n    private readonly Mock&lt;IProductRepository&gt; _mockRepository;\n    private readonly ProductService _service;\n\n    public ProductServiceTests()\n    {\n        _mockRepository = new Mock&lt;IProductRepository&gt;();\n        _service = new ProductService(_mockRepository.Object);\n    }\n\n    [Fact]\n    public async Task GetAllAsync_ShouldReturnAllProducts()\n    {\n        // Arrange\n        var products = new List&lt;Product&gt;\n        {\n            CreateTestProduct(\"Product 1\"),\n            CreateTestProduct(\"Product 2\")\n        };\n\n        _mockRepository.Setup(r =&gt; r.GetAllAsync())\n            .ReturnsAsync(products);\n\n        // Act\n        var result = await _service.GetAllAsync();\n\n        // Assert\n        Assert.Equal(2, result.Count());\n        _mockRepository.Verify(r =&gt; r.GetAllAsync(), Times.Once);\n    }\n\n    [Fact]\n    public async Task CreateAsync_WithValidData_ShouldCreateProduct()\n    {\n        // Arrange\n        var dto = new CreateProductDto(\n            \"Laptop\",\n            \"High performance\",\n            1299.99m,\n            20m,\n            Guid.NewGuid()\n        );\n\n        _mockRepository.Setup(r =&gt; r.AddAsync(It.IsAny&lt;Product&gt;()))\n            .Returns(Task.CompletedTask);\n\n        // Act\n        var result = await _service.CreateAsync(dto);\n\n        // Assert\n        Assert.NotNull(result);\n        Assert.Equal(\"Laptop\", result.Name);\n        Assert.Equal(1299.99m, result.Price);\n        _mockRepository.Verify(r =&gt; r.AddAsync(It.IsAny&lt;Product&gt;()), Times.Once);\n    }\n\n    [Fact]\n    public async Task CreateAsync_WithNegativePrice_ShouldThrowException()\n    {\n        // Arrange\n        var dto = new CreateProductDto(\n            \"Laptop\",\n            \"Description\",\n            -100m,  // Prix n\u00e9gatif\n            20m,\n            Guid.NewGuid()\n        );\n\n        // Act &amp; Assert\n        await Assert.ThrowsAsync&lt;InvalidPriceException&gt;(\n            () =&gt; _service.CreateAsync(dto)\n        );\n\n        _mockRepository.Verify(r =&gt; r.AddAsync(It.IsAny&lt;Product&gt;()), Times.Never);\n    }\n\n    private static Product CreateTestProduct(string name)\n    {\n        return new Product(\n            name,\n            \"Description\",\n            new Price(100m),\n            new VAT(20m),\n            Guid.NewGuid()\n        );\n    }\n}\n</code></pre>"},{"location":"tests/unit-tests/#pattern-aaa-arrange-act-assert","title":"Pattern AAA (Arrange-Act-Assert)","text":"<p>Tous les tests suivent le pattern AAA :</p> <pre><code>[Fact]\npublic void MethodName_Scenario_ExpectedResult()\n{\n    // Arrange - Pr\u00e9parer les donn\u00e9es et d\u00e9pendances\n    var product = CreateTestProduct();\n    var newPrice = new Price(200m);\n\n    // Act - Ex\u00e9cuter l'action \u00e0 tester\n    product.UpdatePrice(newPrice);\n\n    // Assert - V\u00e9rifier le r\u00e9sultat\n    Assert.Equal(200m, product.Price.Value);\n}\n</code></pre>"},{"location":"tests/unit-tests/#moq-mocking-des-dependances","title":"Moq - Mocking des d\u00e9pendances","text":""},{"location":"tests/unit-tests/#setup-dune-methode","title":"Setup d'une m\u00e9thode","text":"<pre><code>_mockRepository.Setup(r =&gt; r.GetByIdAsync(It.IsAny&lt;Guid&gt;()))\n    .ReturnsAsync(testProduct);\n</code></pre>"},{"location":"tests/unit-tests/#verify-quune-methode-a-ete-appelee","title":"Verify qu'une m\u00e9thode a \u00e9t\u00e9 appel\u00e9e","text":"<pre><code>_mockRepository.Verify(r =&gt; r.AddAsync(It.IsAny&lt;Product&gt;()), Times.Once);\n_mockRepository.Verify(r =&gt; r.DeleteAsync(productId), Times.Never);\n</code></pre>"},{"location":"tests/unit-tests/#setup-avec-condition","title":"Setup avec condition","text":"<pre><code>_mockRepository.Setup(r =&gt; r.GetByIdAsync(It.Is&lt;Guid&gt;(id =&gt; id == productId)))\n    .ReturnsAsync(testProduct);\n</code></pre>"},{"location":"tests/unit-tests/#execution-des-tests","title":"Ex\u00e9cution des tests","text":""},{"location":"tests/unit-tests/#tous-les-tests","title":"Tous les tests","text":"<pre><code>dotnet test\n</code></pre>"},{"location":"tests/unit-tests/#tests-dun-projet-specifique","title":"Tests d'un projet sp\u00e9cifique","text":"<pre><code>dotnet test AdvancedDevSample.Test/AdvancedDevSample.Test.csproj\n</code></pre>"},{"location":"tests/unit-tests/#tests-avec-couverture","title":"Tests avec couverture","text":"<pre><code>dotnet test --collect:\"XPlat Code Coverage\"\n</code></pre>"},{"location":"tests/unit-tests/#tests-avec-filtre","title":"Tests avec filtre","text":"<pre><code>dotnet test --filter \"FullyQualifiedName~ProductServiceTests\"\n</code></pre>"},{"location":"tests/unit-tests/#assertions-xunit","title":"Assertions xUnit","text":"<pre><code>// \u00c9galit\u00e9\nAssert.Equal(expected, actual);\nAssert.NotEqual(notExpected, actual);\n\n// Bool\u00e9ens\nAssert.True(condition);\nAssert.False(condition);\n\n// Nullit\u00e9\nAssert.Null(value);\nAssert.NotNull(value);\n\n// Collections\nAssert.Empty(collection);\nAssert.NotEmpty(collection);\nAssert.Contains(item, collection);\n\n// Exceptions\nAssert.Throws&lt;InvalidPriceException&gt;(() =&gt; new Price(-50));\nawait Assert.ThrowsAsync&lt;ProductNotFoundException&gt;(() =&gt; service.GetByIdAsync(id));\n\n// Types\nAssert.IsType&lt;ProductDto&gt;(result);\nAssert.IsAssignableFrom&lt;IEnumerable&lt;ProductDto&gt;&gt;(result);\n</code></pre>"},{"location":"tests/unit-tests/#best-practices","title":"Best Practices","text":""},{"location":"tests/unit-tests/#a-faire","title":"\u2705 \u00c0 faire","text":"<ul> <li>Un test = un comportement</li> <li>Nommage clair : <code>MethodName_Scenario_ExpectedResult</code></li> <li>Pattern AAA syst\u00e9matique</li> <li>Tests ind\u00e9pendants (pas d'ordre d'ex\u00e9cution)</li> <li>Mock des d\u00e9pendances externes</li> </ul>"},{"location":"tests/unit-tests/#a-eviter","title":"\u274c \u00c0 \u00e9viter","text":"<ul> <li>Tests qui d\u00e9pendent les uns des autres</li> <li>Tests avec logique complexe</li> <li>Tests qui acc\u00e8dent \u00e0 une vraie base de donn\u00e9es</li> <li>Assertions multiples sans rapport</li> </ul>"},{"location":"tests/unit-tests/#navigation","title":"Navigation","text":"<ul> <li>Retour aux Tests \u2192</li> <li>Tests d'int\u00e9gration \u2192</li> </ul>"}]}